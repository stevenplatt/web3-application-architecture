(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPubsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPubsub=(()=>{var kc=Object.create;var Jn=Object.defineProperty;var Uc=Object.getOwnPropertyDescriptor;var Kc=Object.getOwnPropertyNames;var Fc=Object.getPrototypeOf,Mc=Object.prototype.hasOwnProperty;var U=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),St=(e,t)=>{for(var r in t)Jn(e,r,{get:t[r],enumerable:!0})},pa=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Kc(t))!Mc.call(e,i)&&i!==r&&Jn(e,i,{get:()=>t[i],enumerable:!(n=Uc(t,i))||n.enumerable});return e};var M=(e,t,r)=>(r=e!=null?kc(Fc(e)):{},pa(t||!e||!e.__esModule?Jn(r,"default",{value:e,enumerable:!0}):r,e)),Oc=e=>pa(Jn({},"__esModule",{value:!0}),e);var ya=U((Ig,da)=>{var Er=1e3,Br=Er*60,Ar=Br*60,er=Ar*24,Vc=er*7,qc=er*365.25;da.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return zc(e);if(r==="number"&&isFinite(e))return t.long?Gc(e):Hc(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function zc(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*qc;case"weeks":case"week":case"w":return r*Vc;case"days":case"day":case"d":return r*er;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ar;case"minutes":case"minute":case"mins":case"min":case"m":return r*Br;case"seconds":case"second":case"secs":case"sec":case"s":return r*Er;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Hc(e){var t=Math.abs(e);return t>=er?Math.round(e/er)+"d":t>=Ar?Math.round(e/Ar)+"h":t>=Br?Math.round(e/Br)+"m":t>=Er?Math.round(e/Er)+"s":e+"ms"}function Gc(e){var t=Math.abs(e);return t>=er?jn(e,t,er,"day"):t>=Ar?jn(e,t,Ar,"hour"):t>=Br?jn(e,t,Br,"minute"):t>=Er?jn(e,t,Er,"second"):e+" ms"}function jn(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var ma=U((_g,ga)=>{function Wc(e){r.debug=r,r.default=r,r.coerce=u,r.disable=s,r.enable=i,r.enabled=o,r.humanize=ya(),r.destroy=f,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let h=0;for(let l=0;l<c.length;l++)h=(h<<5)-h+c.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(c){let h,l=null,d,p;function y(...x){if(!y.enabled)return;let v=y,w=Number(new Date),A=w-(h||w);v.diff=A,v.prev=h,v.curr=w,h=w,x[0]=r.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let P=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(_,V)=>{if(_==="%%")return"%";P++;let q=r.formatters[V];if(typeof q=="function"){let wt=x[P];_=q.call(v,wt),x.splice(P,1),P--}return _}),r.formatArgs.call(v,x),(v.log||r.log).apply(v,x)}return y.namespace=c,y.useColors=r.useColors(),y.color=r.selectColor(c),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(c)),p),set:x=>{l=x}}),typeof r.init=="function"&&r.init(y),y}function n(c,h){let l=r(this.namespace+(typeof h>"u"?":":h)+c);return l.log=this.log,l}function i(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let h,l=(typeof c=="string"?c:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(c=l[h].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function s(){let c=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(c))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack||c.message:c}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ga.exports=Wc});var xa=U((zt,ti)=>{zt.formatArgs=$c;zt.save=Yc;zt.load=Zc;zt.useColors=Qc;zt.storage=Xc();zt.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();zt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Qc(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function $c(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+ti.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}zt.log=console.debug||console.log||(()=>{});function Yc(e){try{e?zt.storage.setItem("debug",e):zt.storage.removeItem("debug")}catch{}}function Zc(){let e;try{e=zt.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Xc(){try{return localStorage}catch{}}ti.exports=ma()(zt);var{formatters:Jc}=ti.exports;Jc.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Ia=U((Xg,Ss)=>{"use strict";var vh=Object.prototype.hasOwnProperty,kt="~";function un(){}Object.create&&(un.prototype=Object.create(null),new un().__proto__||(kt=!1));function bh(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Ca(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new bh(r,n||e,i),o=kt?kt+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function ni(e,t){--e._eventsCount===0?e._events=new un:delete e._events[t]}function Nt(){this._events=new un,this._eventsCount=0}Nt.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)vh.call(r,n)&&t.push(kt?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Nt.prototype.listeners=function(t){var r=kt?kt+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};Nt.prototype.listenerCount=function(t){var r=kt?kt+t:t,n=this._events[r];return n?n.fn?1:n.length:0};Nt.prototype.emit=function(t,r,n,i,s,o){var a=kt?kt+t:t;if(!this._events[a])return!1;var u=this._events[a],f=arguments.length,c,h;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,r),!0;case 3:return u.fn.call(u.context,r,n),!0;case 4:return u.fn.call(u.context,r,n,i),!0;case 5:return u.fn.call(u.context,r,n,i,s),!0;case 6:return u.fn.call(u.context,r,n,i,s,o),!0}for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];u.fn.apply(u.context,c)}else{var l=u.length,d;for(h=0;h<l;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),f){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,r);break;case 3:u[h].fn.call(u[h].context,r,n);break;case 4:u[h].fn.call(u[h].context,r,n,i);break;default:if(!c)for(d=1,c=new Array(f-1);d<f;d++)c[d-1]=arguments[d];u[h].fn.apply(u[h].context,c)}}return!0};Nt.prototype.on=function(t,r,n){return Ca(this,t,r,n,!1)};Nt.prototype.once=function(t,r,n){return Ca(this,t,r,n,!0)};Nt.prototype.removeListener=function(t,r,n,i){var s=kt?kt+t:t;if(!this._events[s])return this;if(!r)return ni(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&ni(this,s);else{for(var a=0,u=[],f=o.length;a<f;a++)(o[a].fn!==r||i&&!o[a].once||n&&o[a].context!==n)&&u.push(o[a]);u.length?this._events[s]=u.length===1?u[0]:u:ni(this,s)}return this};Nt.prototype.removeAllListeners=function(t){var r;return t?(r=kt?kt+t:t,this._events[r]&&ni(this,r)):(this._events=new un,this._eventsCount=0),this};Nt.prototype.off=Nt.prototype.removeListener;Nt.prototype.addListener=Nt.prototype.on;Nt.prefixed=kt;Nt.EventEmitter=Nt;typeof Ss<"u"&&(Ss.exports=Nt)});var Mt=U((N1,Ha)=>{"use strict";function za(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function Nh(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return za(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),za(new i,r)}}Ha.exports=Nh});var J=U((j1,Za)=>{Za.exports={options:{usePureJavaScript:!1}}});var ja=U((t2,Ja)=>{var Ls={};Ja.exports=Ls;var Xa={};Ls.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Fh(e,t);else{var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var u=0,f=e[i];u<a.length;++u)f+=a[u]<<8,a[u]=f%s,f=f/s|0;for(;f>0;)a.push(f%s),f=f/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};Ls.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=Xa[t];if(!r){r=Xa[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var u=0,f=a;u<o.length;++u)f+=o[u]*i,o[u]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var c=0;e[c]===s&&c<e.length-1;++c)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Fh(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var u="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)u+=i;for(r=s.length-1;r>=0;--r)u+=t[s[r]];return u}});var yt=U((e2,n0)=>{var t0=J(),e0=ja(),g=n0.exports=t0.util=t0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(a){return setImmediate(a)};return}if(g.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(u){if(u.source===window&&u.data===e){u.stopPropagation();var f=t.slice();t.length=0,f.forEach(function(c){c()})}};var o=a,e="forge.setImmediate",t=[];g.setImmediate=function(u){t.push(u),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var u=t.slice();t.length=0,u.forEach(function(f){f()})}).observe(i,{attributes:!0});var s=g.setImmediate;g.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),s(u)):(t.push(u),t.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};g.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};g.isArrayBufferView=function(e){return e&&g.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function bn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}g.ByteBuffer=Ps;function Ps(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(g.isArrayBuffer(e)||g.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Ps||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}g.ByteStringBuffer=Ps;var Mh=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Mh&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};g.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};g.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};g.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(g.encodeUtf8(e))};g.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};g.ByteStringBuffer.prototype.putInt=function(e,t){bn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};g.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};g.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};g.ByteStringBuffer.prototype.getInt=function(e){bn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};g.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};g.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var e=g.createBuffer(this.data);return e.read=this.read,e};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function Oh(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=g.isArrayBuffer(e),n=g.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}g.DataBuffer=Oh;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};g.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};g.DataBuffer.prototype.putBytes=function(e,t){if(g.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof g.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&g.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof g.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=g.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};g.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};g.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};g.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(e,t){bn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};g.DataBuffer.prototype.putSignedInt=function(e,t){return bn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};g.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};g.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};g.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};g.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};g.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};g.DataBuffer.prototype.getInt=function(e){bn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};g.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};g.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return g.binary.raw.encode(t);if(e==="hex")return g.binary.hex.encode(t);if(e==="base64")return g.binary.base64.encode(t);if(e==="utf8")return g.text.utf8.decode(t);if(e==="utf16")return g.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};g.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=g.encodeUtf8(e)),new g.ByteBuffer(e)};g.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};g.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};g.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};g.bytesToHex=function(e){return g.createBuffer(e).toHex()};g.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qe=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],r0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.length;)i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=Ve.charAt(i>>2),r+=Ve.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ve.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Ve.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,o=0;o<e.length;)r=qe[e.charCodeAt(o++)-43],n=qe[e.charCodeAt(o++)-43],i=qe[e.charCodeAt(o++)-43],s=qe[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};g.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};g.decodeUtf8=function(e){return decodeURIComponent(escape(e))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e0.encode,decode:e0.decode}};g.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};g.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};g.binary.base64.encode=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.byteLength;)i=e[a++],s=e[a++],o=e[a++],r+=Ve.charAt(i>>2),r+=Ve.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Ve.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Ve.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,u=0,f=r;u<e.length;)i=qe[e.charCodeAt(u++)-43],s=qe[e.charCodeAt(u++)-43],o=qe[e.charCodeAt(u++)-43],a=qe[e.charCodeAt(u++)-43],n[f++]=i<<2|s>>4,o!==64&&(n[f++]=(s&15)<<4|o>>2,a!==64&&(n[f++]=(o&3)<<6|a));return t?f-r:n.subarray(0,f)};g.binary.base58.encode=function(e,t){return g.binary.baseN.encode(e,r0,t)};g.binary.base58.decode=function(e,t){return g.binary.baseN.decode(e,r0,t)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(e,t,r){e=g.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.text.utf8.decode=function(e){return g.decodeUtf8(String.fromCharCode.apply(null,e))};g.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n};g.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};g.deflate=function(e,t,r){if(t=g.decode64(e.deflate(g.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};g.inflate=function(e,t,r){var n=e.inflate(g.encode64(t)).rval;return n===null?null:g.decode64(n)};var Ds=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=g.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ks=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},Vh=function(e,t,r,n){var i=ks(e,t);i===null&&(i={}),i[r]=n,Ds(e,t,i)},qh=function(e,t,r){var n=ks(e,t);return n!==null&&(n=r in n?n[r]:null),n},zh=function(e,t,r){var n=ks(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Ds(e,t,n)}},Hh=function(e,t){Ds(e,t,null)},gi=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(u){o=u}if(s)break}if(!s)throw o;return n};g.setItem=function(e,t,r,n,i){gi(Vh,arguments,i)};g.getItem=function(e,t,r,n){return gi(qh,arguments,n)};g.removeItem=function(e,t,r,n){gi(zh,arguments,n)};g.clearItems=function(e,t,r){gi(Hh,arguments,r)};g.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};g.format=function(e){for(var t=/%./g,r,n,i=0,s=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&s.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")};g.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,u=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",c=f.length>3?f.length%3:0;return u+(c?f.substr(0,c)+a:"")+f.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-f).toFixed(s).slice(2):"")};g.formatSize=function(e){return e>=1073741824?e=g.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=g.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=g.formatNumber(e/1024,0)+" KiB":e=g.formatNumber(e,0)+" bytes",e};g.bytesFromIP=function(e){return e.indexOf(".")!==-1?g.bytesFromIPv4(e):e.indexOf(":")!==-1?g.bytesFromIPv6(e):null};g.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=g.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};g.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=g.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=g.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};g.bytesToIP=function(e){return e.length===4?g.bytesToIPv4(e):e.length===16?g.bytesToIPv6(e):null};g.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};g.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=g.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),u.start===0&&t.unshift(""),u.end===7&&t.push(""))}return t.join(":")};g.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in g&&!e.update)return t(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,t(null,g.cores);if(typeof Worker>"u")return g.cores=1,t(null,g.cores);if(typeof Blob>"u")return g.cores=2,t(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),u=a+4;Date.now()<u;);self.postMessage({st:a,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,u){if(a===0){var f=Math.floor(o.reduce(function(c,h){return c+h},0)/o.length);return g.cores=Math.max(1,f),URL.revokeObjectURL(r),t(null,g.cores)}i(u,function(c,h){o.push(s(u,h)),n(o,a-1,u)})}function i(o,a){for(var u=[],f=[],c=0;c<o;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===o){for(var d=0;d<o;++d)u[d].terminate();a(null,f)}}),u.push(h)}for(var c=0;c<o;++c)u[c].postMessage(c)}function s(o,a){for(var u=[],f=0;f<o;++f)for(var c=a[f],h=u[f]=[],l=0;l<o;++l)if(f!==l){var d=a[l];(c.st>d.st&&c.st<d.et||d.st>c.st&&d.st<c.et)&&h.push(l)}return u.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var Ks=U((r2,i0)=>{var At=J();yt();i0.exports=At.cipher=At.cipher||{};At.cipher.algorithms=At.cipher.algorithms||{};At.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=At.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};At.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=At.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};At.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),At.cipher.algorithms[e]=t};At.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in At.cipher.algorithms?At.cipher.algorithms[e]:null};var Us=At.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Us.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=At.util.createBuffer(),this.output=e.output||At.util.createBuffer(),this.mode.start(t)};Us.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Us.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Ms=U((n2,s0)=>{var Ct=J();yt();Ct.cipher=Ct.cipher||{};var O=s0.exports=Ct.cipher.modes=Ct.cipher.modes||{};O.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(e){};O.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};O.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=mi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};O.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ct.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ct.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ct.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}xi(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ct.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Ct.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Ct.util.createBuffer(e.additionalData):r=Ct.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Ct.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Fs(n*8)))}this._inBlock=this._j0.slice(0),xi(this._inBlock),this._partialBytes=0,r=Ct.util.createBuffer(r),this._aDataLength=Fs(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),xi(this._inBlock)};O.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),xi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Ct.util.createBuffer();var n=this._aDataLength.concat(Fs(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};O.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};O.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};O.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],u=o/n|0,f=(n-1-o%n)*t;a[u]=1<<t-1<<f,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s};O.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],u=i[o];i[s+o]=[a[0]^u[0],a[1]^u[1],a[2]^u[2],a[3]^u[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var f=i[s^n];i[s]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return i};function mi(e,t){if(typeof e=="string"&&(e=Ct.util.createBuffer(e)),Ct.util.isArray(e)&&e.length>4){var r=e;e=Ct.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Ct.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function xi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Fs(e){return[e/4294967296|0,e&4294967295]}});var bi=U((i2,f0)=>{var j=J();Ks();Ms();yt();f0.exports=j.aes=j.aes||{};j.aes.startEncrypting=function(e,t,r,n){var i=vi({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};j.aes.createEncryptionCipher=function(e,t){return vi({key:e,output:null,decrypt:!1,mode:t})};j.aes.startDecrypting=function(e,t,r,n){var i=vi({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};j.aes.createDecryptionCipher=function(e,t){return vi({key:e,output:null,decrypt:!0,mode:t})};j.aes.Algorithm=function(e,t){qs||a0();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return Vs(r._w,n,i,!1)},decrypt:function(n,i){return Vs(r._w,n,i,!0)}}}),r._init=!1};j.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=j.util.createBuffer(t);else if(j.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=j.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!j.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!j.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=u0(t,e.decrypt&&!o),this._init=!0}};j.aes._expandKey=function(e,t){return qs||a0(),u0(e,t)};j.aes._updateBlock=Vs;Nr("AES-ECB",j.cipher.modes.ecb);Nr("AES-CBC",j.cipher.modes.cbc);Nr("AES-CFB",j.cipher.modes.cfb);Nr("AES-OFB",j.cipher.modes.ofb);Nr("AES-CTR",j.cipher.modes.ctr);Nr("AES-GCM",j.cipher.modes.gcm);function Nr(e,t){var r=function(){return new j.aes.Algorithm(e,t)};j.cipher.registerAlgorithm(e,r)}var qs=!1,Rr=4,Ut,Os,o0,ur,re;function a0(){qs=!0,o0=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Ut=new Array(256),Os=new Array(256),ur=new Array(4),re=new Array(4);for(var t=0;t<4;++t)ur[t]=new Array(256),re[t]=new Array(256);for(var r=0,n=0,i,s,o,a,u,f,c,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Ut[r]=a,Os[a]=r,u=e[a],i=e[r],s=e[i],o=e[s],f=u<<24^a<<16^a<<8^(a^u),c=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)ur[h][r]=f,re[h][a]=c,f=f<<24|f>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=i^e[e[e[i^o]]],n^=e[e[n]])}}function u0(e,t){for(var r=e.slice(0),n,i=1,s=r.length,o=s+6+1,a=Rr*o,u=s;u<a;++u)n=r[u-1],u%s===0?(n=Ut[n>>>16&255]<<24^Ut[n>>>8&255]<<16^Ut[n&255]<<8^Ut[n>>>24]^o0[i]<<24,i++):s>6&&u%s===4&&(n=Ut[n>>>24]<<24^Ut[n>>>16&255]<<16^Ut[n>>>8&255]<<8^Ut[n&255]),r[u]=r[u-s]^n;if(t){var f,c=re[0],h=re[1],l=re[2],d=re[3],p=r.slice(0);a=r.length;for(var u=0,y=a-Rr;u<a;u+=Rr,y-=Rr)if(u===0||u===a-Rr)p[u]=r[y],p[u+1]=r[y+3],p[u+2]=r[y+2],p[u+3]=r[y+1];else for(var x=0;x<Rr;++x)f=r[y+x],p[u+(3&-x)]=c[Ut[f>>>24]]^h[Ut[f>>>16&255]]^l[Ut[f>>>8&255]]^d[Ut[f&255]];r=p}return r}function Vs(e,t,r,n){var i=e.length/4-1,s,o,a,u,f;n?(s=re[0],o=re[1],a=re[2],u=re[3],f=Os):(s=ur[0],o=ur[1],a=ur[2],u=ur[3],f=Ut);var c,h,l,d,p,y,x;c=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var v=3,w=1;w<i;++w)p=s[c>>>24]^o[h>>>16&255]^a[l>>>8&255]^u[d&255]^e[++v],y=s[h>>>24]^o[l>>>16&255]^a[d>>>8&255]^u[c&255]^e[++v],x=s[l>>>24]^o[d>>>16&255]^a[c>>>8&255]^u[h&255]^e[++v],d=s[d>>>24]^o[c>>>16&255]^a[h>>>8&255]^u[l&255]^e[++v],c=p,h=y,l=x;r[0]=f[c>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[d&255]^e[++v],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[d>>>8&255]<<8^f[c&255]^e[++v],r[2]=f[l>>>24]<<24^f[d>>>16&255]<<16^f[c>>>8&255]<<8^f[h&255]^e[++v],r[n?1:3]=f[d>>>24]<<24^f[c>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^e[++v]}function vi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=j.cipher.createDecipher(r,e.key):n=j.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof j.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var A0=U(($2,B0)=>{"use strict";B0.exports=Kl;function Kl(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,u){r[n]=function(c){if(s)if(s=!1,c)u(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{e.apply(t||null,r)}catch(f){s&&(s=!1,u(f))}})}});var T0=U(_0=>{"use strict";var Ei=_0;Ei.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var Kr=new Array(64),I0=new Array(123);for(ne=0;ne<64;)I0[Kr[ne]=ne<26?ne+65:ne<52?ne+71:ne<62?ne-4:ne-59|43]=ne++;var ne;Ei.encode=function(t,r,n){for(var i=null,s=[],o=0,a=0,u;r<n;){var f=t[r++];switch(a){case 0:s[o++]=Kr[f>>2],u=(f&3)<<4,a=1;break;case 1:s[o++]=Kr[u|f>>4],u=(f&15)<<2,a=2;break;case 2:s[o++]=Kr[u|f>>6],s[o++]=Kr[f&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Kr[u],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var C0="invalid encoding";Ei.decode=function(t,r,n){for(var i=n,s=0,o,a=0;a<t.length;){var u=t.charCodeAt(a++);if(u===61&&s>1)break;if((u=I0[u])===void 0)throw Error(C0);switch(s){case 0:o=u,s=1;break;case 1:r[n++]=o<<2|(u&48)>>4,o=u,s=2;break;case 2:r[n++]=(o&15)<<4|(u&60)>>2,o=u,s=3;break;case 3:r[n++]=(o&3)<<6|u,s=0;break}}if(s===1)throw Error(C0);return n-i};Ei.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var N0=U((Z2,R0)=>{"use strict";R0.exports=Bi;function Bi(){this._listeners={}}Bi.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};Bi.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Bi.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var F0=U((X2,K0)=>{"use strict";K0.exports=L0(L0);function L0(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(u,f,c){t[0]=u,f[c]=r[0],f[c+1]=r[1],f[c+2]=r[2],f[c+3]=r[3]}function s(u,f,c){t[0]=u,f[c]=r[3],f[c+1]=r[2],f[c+2]=r[1],f[c+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function o(u,f){return r[0]=u[f],r[1]=u[f+1],r[2]=u[f+2],r[3]=u[f+3],t[0]}function a(u,f){return r[3]=u[f],r[2]=u[f+1],r[1]=u[f+2],r[0]=u[f+3],t[0]}e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var u=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-u)*8388608)&8388607;n((a<<31|u+127<<23|f)>>>0,s,o)}}e.writeFloatLE=t.bind(null,P0),e.writeFloatBE=t.bind(null,D0);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,u=o>>>23&255,f=o&8388607;return u===255?f?NaN:a*(1/0):u===0?a*1401298464324817e-60*f:a*Math.pow(2,u-150)*(f+8388608)}e.readFloatLE=r.bind(null,k0),e.readFloatBE=r.bind(null,U0)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(u,f,c){t[0]=u,f[c]=r[0],f[c+1]=r[1],f[c+2]=r[2],f[c+3]=r[3],f[c+4]=r[4],f[c+5]=r[5],f[c+6]=r[6],f[c+7]=r[7]}function s(u,f,c){t[0]=u,f[c]=r[7],f[c+1]=r[6],f[c+2]=r[5],f[c+3]=r[4],f[c+4]=r[3],f[c+5]=r[2],f[c+6]=r[1],f[c+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function o(u,f){return r[0]=u[f],r[1]=u[f+1],r[2]=u[f+2],r[3]=u[f+3],r[4]=u[f+4],r[5]=u[f+5],r[6]=u[f+6],r[7]=u[f+7],t[0]}function a(u,f){return r[7]=u[f],r[6]=u[f+1],r[5]=u[f+2],r[4]=u[f+3],r[3]=u[f+4],r[2]=u[f+5],r[1]=u[f+6],r[0]=u[f+7],t[0]}e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(n,i,s,o,a,u){var f=o<0?1:0;if(f&&(o=-o),o===0)n(0,a,u+i),n(1/o>0?0:2147483648,a,u+s);else if(isNaN(o))n(0,a,u+i),n(2146959360,a,u+s);else if(o>17976931348623157e292)n(0,a,u+i),n((f<<31|2146435072)>>>0,a,u+s);else{var c;if(o<22250738585072014e-324)c=o/5e-324,n(c>>>0,a,u+i),n((f<<31|c/4294967296)>>>0,a,u+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),c=o*Math.pow(2,-h),n(c*4503599627370496>>>0,a,u+i),n((f<<31|h+1023<<20|c*1048576&1048575)>>>0,a,u+s)}}}e.writeDoubleLE=t.bind(null,P0,0,4),e.writeDoubleBE=t.bind(null,D0,4,0);function r(n,i,s,o,a){var u=n(o,a+i),f=n(o,a+s),c=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+u;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,k0,0,4),e.readDoubleBE=r.bind(null,U0,4,0)}(),e}function P0(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function D0(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function k0(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function U0(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var M0=U((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var V0=U(O0=>{"use strict";var no=O0;no.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};no.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,u;r<n;)u=t[r++],u<128?o[a++]=u:u>191&&u<224?o[a++]=(u&31)<<6|t[r++]&63:u>239&&u<365?(u=((u&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,o[a++]=55296+(u>>10),o[a++]=56320+(u&1023)):o[a++]=(u&15)<<12|(t[r++]&63)<<6|t[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};no.write=function(t,r,n){for(var i=n,s,o,a=0;a<t.length;++a)s=t.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var z0=U((j2,q0)=>{"use strict";q0.exports=Fl;function Fl(e,t,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(u){if(u<1||u>i)return e(u);o+u>n&&(s=e(n),o=0);var f=t.call(s,o,o+=u);return o&7&&(o=(o|7)+1),f}}});var G0=U((tm,H0)=>{"use strict";H0.exports=It;var An=cr();function It(e,t){this.lo=e>>>0,this.hi=t>>>0}var fr=It.zero=new It(0,0);fr.toNumber=function(){return 0};fr.zzEncode=fr.zzDecode=function(){return this};fr.length=function(){return 1};var Ml=It.zeroHash="\0\0\0\0\0\0\0\0";It.fromNumber=function(t){if(t===0)return fr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new It(n,i)};It.from=function(t){if(typeof t=="number")return It.fromNumber(t);if(An.isString(t))if(An.Long)t=An.Long.fromString(t);else return It.fromNumber(parseInt(t,10));return t.low||t.high?new It(t.low>>>0,t.high>>>0):fr};It.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};It.prototype.toLong=function(t){return An.Long?new An.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var He=String.prototype.charCodeAt;It.fromHash=function(t){return t===Ml?fr:new It((He.call(t,0)|He.call(t,1)<<8|He.call(t,2)<<16|He.call(t,3)<<24)>>>0,(He.call(t,4)|He.call(t,5)<<8|He.call(t,6)<<16|He.call(t,7)<<24)>>>0)};It.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};It.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};It.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};It.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var cr=U(io=>{"use strict";var L=io;L.asPromise=A0();L.base64=T0();L.EventEmitter=N0();L.float=F0();L.inquire=M0();L.utf8=V0();L.pool=z0();L.LongBits=G0();L.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);L.global=L.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||io;L.emptyArray=Object.freeze?Object.freeze([]):[];L.emptyObject=Object.freeze?Object.freeze({}):{};L.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};L.isString=function(t){return typeof t=="string"||t instanceof String};L.isObject=function(t){return t&&typeof t=="object"};L.isset=L.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};L.Buffer=function(){try{var e=L.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();L._Buffer_from=null;L._Buffer_allocUnsafe=null;L.newBuffer=function(t){return typeof t=="number"?L.Buffer?L._Buffer_allocUnsafe(t):new L.Array(t):L.Buffer?L._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};L.Array=typeof Uint8Array<"u"?Uint8Array:Array;L.Long=L.global.dcodeIO&&L.global.dcodeIO.Long||L.global.Long||L.inquire("long");L.key2Re=/^true|false|0|1$/;L.key32Re=/^-?(?:0|[1-9][0-9]*)$/;L.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;L.longToHash=function(t){return t?L.LongBits.from(t).toHash():L.LongBits.zeroHash};L.longFromHash=function(t,r){var n=L.LongBits.fromHash(t);return L.Long?L.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function W0(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}L.merge=W0;L.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Q0(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&W0(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}L.newError=Q0;L.ProtocolError=Q0("ProtocolError");L.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};L.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};L.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};L._configure=function(){var e=L.Buffer;if(!e){L._Buffer_from=L._Buffer_allocUnsafe=null;return}L._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},L._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var ao=U((rm,J0)=>{"use strict";J0.exports=gt;var de=cr(),oo,Z0=de.LongBits,Ol=de.utf8;function ie(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function gt(e){this.buf=e,this.pos=0,this.len=e.length}var $0=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new gt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new gt(t);throw Error("illegal buffer")},X0=function(){return de.Buffer?function(r){return(gt.create=function(i){return de.Buffer.isBuffer(i)?new oo(i):$0(i)})(r)}:$0};gt.create=X0();gt.prototype._slice=de.Array.prototype.subarray||de.Array.prototype.slice;gt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,ie(this,10);return t}}();gt.prototype.int32=function(){return this.uint32()|0};gt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function so(){var e=new Z0(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw ie(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw ie(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}gt.prototype.bool=function(){return this.uint32()!==0};function Ai(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}gt.prototype.fixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return Ai(this.buf,this.pos+=4)};gt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return Ai(this.buf,this.pos+=4)|0};function Y0(){if(this.pos+8>this.len)throw ie(this,8);return new Z0(Ai(this.buf,this.pos+=4),Ai(this.buf,this.pos+=4))}gt.prototype.float=function(){if(this.pos+4>this.len)throw ie(this,4);var t=de.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};gt.prototype.double=function(){if(this.pos+8>this.len)throw ie(this,4);var t=de.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};gt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw ie(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};gt.prototype.string=function(){var t=this.bytes();return Ol.read(t,0,t.length)};gt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw ie(this,t);this.pos+=t}else do if(this.pos>=this.len)throw ie(this);while(this.buf[this.pos++]&128);return this};gt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};gt._configure=function(e){oo=e,gt.create=X0(),oo._configure();var t=de.Long?"toLong":"toNumber";de.merge(gt.prototype,{int64:function(){return so.call(this)[t](!1)},uint64:function(){return so.call(this)[t](!0)},sint64:function(){return so.call(this).zzDecode()[t](!1)},fixed64:function(){return Y0.call(this)[t](!0)},sfixed64:function(){return Y0.call(this)[t](!1)}})}});var ru=U((nm,eu)=>{"use strict";eu.exports=hr;var tu=ao();(hr.prototype=Object.create(tu.prototype)).constructor=hr;var j0=cr();function hr(e){tu.call(this,e)}hr._configure=function(){j0.Buffer&&(hr.prototype._slice=j0.Buffer.prototype.slice)};hr.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};hr._configure()});var yo=U((im,ou)=>{"use strict";ou.exports=Q;var Zt=cr(),uo,Ci=Zt.LongBits,nu=Zt.base64,iu=Zt.utf8;function Cn(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function co(){}function Vl(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Q(){this.len=0,this.head=new Cn(co,0,0),this.tail=this.head,this.states=null}var su=function(){return Zt.Buffer?function(){return(Q.create=function(){return new uo})()}:function(){return new Q}};Q.create=su();Q.alloc=function(t){return new Zt.Array(t)};Zt.Array!==Array&&(Q.alloc=Zt.pool(Q.alloc,Zt.Array.prototype.subarray));Q.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Cn(t,r,n),this.len+=r,this};function ho(e,t,r){t[r]=e&255}function ql(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function lo(e,t){this.len=e,this.next=void 0,this.val=t}lo.prototype=Object.create(Cn.prototype);lo.prototype.fn=ql;Q.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new lo((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};Q.prototype.int32=function(t){return t<0?this._push(po,10,Ci.fromNumber(t)):this.uint32(t)};Q.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function po(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}Q.prototype.uint64=function(t){var r=Ci.from(t);return this._push(po,r.length(),r)};Q.prototype.int64=Q.prototype.uint64;Q.prototype.sint64=function(t){var r=Ci.from(t).zzEncode();return this._push(po,r.length(),r)};Q.prototype.bool=function(t){return this._push(ho,1,t?1:0)};function fo(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Q.prototype.fixed32=function(t){return this._push(fo,4,t>>>0)};Q.prototype.sfixed32=Q.prototype.fixed32;Q.prototype.fixed64=function(t){var r=Ci.from(t);return this._push(fo,4,r.lo)._push(fo,4,r.hi)};Q.prototype.sfixed64=Q.prototype.fixed64;Q.prototype.float=function(t){return this._push(Zt.float.writeFloatLE,4,t)};Q.prototype.double=function(t){return this._push(Zt.float.writeDoubleLE,8,t)};var zl=Zt.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};Q.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(ho,1,0);if(Zt.isString(t)){var n=Q.alloc(r=nu.length(t));nu.decode(t,n,0),t=n}return this.uint32(r)._push(zl,r,t)};Q.prototype.string=function(t){var r=iu.length(t);return r?this.uint32(r)._push(iu.write,r,t):this._push(ho,1,0)};Q.prototype.fork=function(){return this.states=new Vl(this),this.head=this.tail=new Cn(co,0,0),this.len=0,this};Q.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Cn(co,0,0),this.len=0),this};Q.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};Q.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};Q._configure=function(e){uo=e,Q.create=su(),uo._configure()}});var fu=U((sm,uu)=>{"use strict";uu.exports=ye;var au=yo();(ye.prototype=Object.create(au.prototype)).constructor=ye;var Ge=cr();function ye(){au.call(this)}ye._configure=function(){ye.alloc=Ge._Buffer_allocUnsafe,ye.writeBytesBuffer=Ge.Buffer&&Ge.Buffer.prototype instanceof Uint8Array&&Ge.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};ye.prototype.bytes=function(t){Ge.isString(t)&&(t=Ge._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(ye.writeBytesBuffer,r,t),this};function Hl(e,t,r){e.length<40?Ge.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}ye.prototype.string=function(t){var r=Ge.Buffer.byteLength(t);return this.uint32(r),r&&this._push(Hl,r,t),this};ye._configure()});var Ni=U((Em,du)=>{var In=J();In.pki=In.pki||{};var So=du.exports=In.pki.oids=In.oids=In.oids||{};function B(e,t){So[e]=t,So[t]=e}function X(e,t){So[e]=t}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("2.16.840.1.101.3.4.2.4","sha224");B("2.16.840.1.101.3.4.2.5","sha512-224");B("2.16.840.1.101.3.4.2.6","sha512-256");B("1.2.840.113549.2.2","md2");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");X("2.5.29.1","authorityKeyIdentifier");X("2.5.29.2","keyAttributes");X("2.5.29.3","certificatePolicies");X("2.5.29.4","keyUsageRestriction");X("2.5.29.5","policyMapping");X("2.5.29.6","subtreesConstraint");X("2.5.29.7","subjectAltName");X("2.5.29.8","issuerAltName");X("2.5.29.9","subjectDirectoryAttributes");X("2.5.29.10","basicConstraints");X("2.5.29.11","nameConstraints");X("2.5.29.12","policyConstraints");X("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");X("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");X("2.5.29.20","cRLNumber");X("2.5.29.21","cRLReason");X("2.5.29.22","expirationDate");X("2.5.29.23","instructionCode");X("2.5.29.24","invalidityDate");X("2.5.29.25","cRLDistributionPoints");X("2.5.29.26","issuingDistributionPoint");X("2.5.29.27","deltaCRLIndicator");X("2.5.29.28","issuingDistributionPoint");X("2.5.29.29","certificateIssuer");X("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");X("2.5.29.33","policyMappings");X("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");X("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");X("2.5.29.46","freshestCRL");X("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Tn=U((Bm,gu)=>{var et=J();yt();Ni();var I=gu.exports=et.asn1=et.asn1||{};I.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};I.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};I.create=function(e,t,r,n,i){if(et.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:e,type:t,constructed:r,composed:r||et.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=I.copy(a)),a};I.copy=function(e,t){var r;if(et.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(I.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:I.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};I.equals=function(e,t,r){if(et.util.isArray(e)){if(!et.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!I.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&I.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};I.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function _n(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var $l=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;_n(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};I.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=et.util.createBuffer(e));var r=e.length(),n=Li(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Li(e,t,r,n){var i;_n(e,t,2);var s=e.getByte();t--;var o=s&192,a=s&31;i=e.length();var u=$l(e,t);if(t-=i-e.length(),u!==void 0&&u>t){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=u,f}u=t}var c,h,l=(s&32)===32;if(l)if(c=[],u===void 0)for(;;){if(_n(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),c.push(Li(e,t,r+1,n)),t-=i-e.length()}else for(;u>0;)i=e.length(),c.push(Li(e,u,r+1,n)),t-=i-e.length(),u-=i-e.length();if(c===void 0&&o===I.Class.UNIVERSAL&&a===I.Type.BITSTRING&&(h=e.bytes(u)),c===void 0&&n.decodeBitStrings&&o===I.Class.UNIVERSAL&&a===I.Type.BITSTRING&&u>1){var d=e.read,p=t,y=0;if(a===I.Type.BITSTRING&&(_n(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var x={strict:!0,decodeBitStrings:!0},v=Li(e,t,r+1,x),w=i-e.length();t-=w,a==I.Type.BITSTRING&&w++;var A=v.tagClass;w===u&&(A===I.Class.UNIVERSAL||A===I.Class.CONTEXT_SPECIFIC)&&(c=[v])}catch{}c===void 0&&(e.read=d,t=p)}if(c===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=t}if(a===I.Type.BMPSTRING)for(c="";u>0;u-=2)_n(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(u),t-=u}var P=h===void 0?null:{bitStringContents:h};return I.create(o,a,l,c,P)}I.toDer=function(e){var t=et.util.createBuffer(),r=e.tagClass|e.type,n=et.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=I.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(I.toDer(e.value[s]))}else if(e.type===I.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===I.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(n),t};I.oidToDer=function(e){var t=e.split("."),r=et.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,a=2;a<t.length;++a){n=!0,i=[],s=parseInt(t[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var u=i.length-1;u>=0;--u)r.putByte(i[u])}return r};I.derToOid=function(e){var t;typeof e=="string"&&(e=et.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};I.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var u=e.charAt(10),f=10;u!=="+"&&u!=="-"&&(a=parseInt(e.substr(10,2),10),f+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),f&&(u=e.charAt(f),u==="+"||u==="-")){var c=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10),l=c*60+h;l*=6e4,u==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};I.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),u=0,f=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);f=d*60+p,f*=6e4,l==="+"&&(f*=-1),c=!0}return e.charAt(14)==="."&&(u=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,u),t.setTime(+t+f)):(t.setFullYear(r,n,i),t.setHours(s,o,a,u)),t};I.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};I.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};I.integerToDer=function(e){var t=et.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};I.derToInteger=function(e){typeof e=="string"&&(e=et.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};I.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&et.util.isArray(t.value))for(var s=0,o=0;i&&o<t.value.length;++o)i=t.value[o].optional||!1,e.value[s]&&(i=I.validate(e.value[s],t.value[o],r,n),i?++s:t.value[o].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var u=e.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var yu=/[^\\u0000-\\u00ff]/;I.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case I.Class.UNIVERSAL:n+="Universal:";break;case I.Class.APPLICATION:n+="Application:";break;case I.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case I.Class.PRIVATE:n+="Private:";break}if(e.tagClass===I.Class.UNIVERSAL)switch(n+=e.type,e.type){case I.Type.NONE:n+=" (None)";break;case I.Type.BOOLEAN:n+=" (Boolean)";break;case I.Type.INTEGER:n+=" (Integer)";break;case I.Type.BITSTRING:n+=" (Bit string)";break;case I.Type.OCTETSTRING:n+=" (Octet string)";break;case I.Type.NULL:n+=" (Null)";break;case I.Type.OID:n+=" (Object Identifier)";break;case I.Type.ODESC:n+=" (Object Descriptor)";break;case I.Type.EXTERNAL:n+=" (External or Instance of)";break;case I.Type.REAL:n+=" (Real)";break;case I.Type.ENUMERATED:n+=" (Enumerated)";break;case I.Type.EMBEDDED:n+=" (Embedded PDV)";break;case I.Type.UTF8:n+=" (UTF8)";break;case I.Type.ROID:n+=" (Relative Object Identifier)";break;case I.Type.SEQUENCE:n+=" (Sequence)";break;case I.Type.SET:n+=" (Set)";break;case I.Type.PRINTABLESTRING:n+=" (Printable String)";break;case I.Type.IA5String:n+=" (IA5String (ASCII))";break;case I.Type.UTCTIME:n+=" (UTC time)";break;case I.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case I.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(o+=1,a+=I.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",e.type===I.Type.OID){var u=I.derToOid(e.value);n+=u,et.pki&&et.pki.oids&&u in et.pki.oids&&(n+=" ("+et.pki.oids[u]+") ")}if(e.type===I.Type.INTEGER)try{n+=I.derToInteger(e.value)}catch{n+="0x"+et.util.bytesToHex(e.value)}else if(e.type===I.Type.BITSTRING){if(e.value.length>1?n+="0x"+et.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(e.type===I.Type.OCTETSTRING)yu.test(e.value)||(n+="("+e.value+") "),n+="0x"+et.util.bytesToHex(e.value);else if(e.type===I.Type.UTF8)try{n+=et.util.decodeUtf8(e.value)}catch(c){if(c.message==="URI malformed")n+="0x"+et.util.bytesToHex(e.value)+" (malformed UTF8)";else throw c}else e.type===I.Type.PRINTABLESTRING||e.type===I.Type.IA5String?n+=e.value:yu.test(e.value)?n+="0x"+et.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var vu=U((Am,xu)=>{var st=J();Ks();Ms();yt();xu.exports=st.des=st.des||{};st.des.startEncrypting=function(e,t,r,n){var i=Pi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};st.des.createEncryptionCipher=function(e,t){return Pi({key:e,output:null,decrypt:!1,mode:t})};st.des.startDecrypting=function(e,t,r,n){var i=Pi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};st.des.createDecryptionCipher=function(e,t){return Pi({key:e,output:null,decrypt:!0,mode:t})};st.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return mu(r._keys,n,i,!1)},decrypt:function(n,i){return mu(r._keys,n,i,!0)}}}),r._init=!1};st.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=st.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=np(t),this._init=!0}};ge("DES-ECB",st.cipher.modes.ecb);ge("DES-CBC",st.cipher.modes.cbc);ge("DES-CFB",st.cipher.modes.cfb);ge("DES-OFB",st.cipher.modes.ofb);ge("DES-CTR",st.cipher.modes.ctr);ge("3DES-ECB",st.cipher.modes.ecb);ge("3DES-CBC",st.cipher.modes.cbc);ge("3DES-CFB",st.cipher.modes.cfb);ge("3DES-OFB",st.cipher.modes.ofb);ge("3DES-CTR",st.cipher.modes.ctr);function ge(e,t){var r=function(){return new st.des.Algorithm(e,t)};st.cipher.registerAlgorithm(e,r)}var Yl=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Zl=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Xl=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Jl=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],jl=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],tp=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],ep=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],rp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function np(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,x=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,A,P=0;P<y;P++){var C=e.getInt32(),_=e.getInt32();A=(C>>>4^_)&252645135,_^=A,C^=A<<4,A=(_>>>-16^C)&65535,C^=A,_^=A<<-16,A=(C>>>2^_)&858993459,_^=A,C^=A<<2,A=(_>>>-16^C)&65535,C^=A,_^=A<<-16,A=(C>>>1^_)&1431655765,_^=A,C^=A<<1,A=(_>>>8^C)&16711935,C^=A,_^=A<<8,A=(C>>>1^_)&1431655765,_^=A,C^=A<<1,A=C<<8|_>>>20&240,C=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var V=0;V<v.length;++V){v[V]?(C=C<<2|C>>>26,_=_<<2|_>>>26):(C=C<<1|C>>>27,_=_<<1|_>>>27),C&=-15,_&=-15;var q=t[C>>>28]|r[C>>>24&15]|n[C>>>20&15]|i[C>>>16&15]|s[C>>>12&15]|o[C>>>8&15]|a[C>>>4&15],wt=u[_>>>28]|f[_>>>24&15]|c[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(wt>>>16^q)&65535,x[w++]=q^A,x[w++]=wt^A<<16}}return x}function mu(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],u=t[1];o=(a>>>4^u)&252645135,u^=o,a^=o<<4,o=(a>>>16^u)&65535,u^=o,a^=o<<16,o=(u>>>2^a)&858993459,a^=o,u^=o<<2,o=(u>>>8^a)&16711935,a^=o,u^=o<<8,o=(a>>>1^u)&1431655765,u^=o,a^=o<<1,a=a<<1|a>>>31,u=u<<1|u>>>31;for(var f=0;f<i;f+=3){for(var c=s[f+1],h=s[f+2],l=s[f];l!=c;l+=h){var d=u^e[l],p=(u>>>4|u<<28)^e[l+1];o=a,a=u,u=o^(Zl[d>>>24&63]|Jl[d>>>16&63]|tp[d>>>8&63]|rp[d&63]|Yl[p>>>24&63]|Xl[p>>>16&63]|jl[p>>>8&63]|ep[p&63])}o=a,a=u,u=o}a=a>>>1|a<<31,u=u>>>1|u<<31,o=(a>>>1^u)&1431655765,u^=o,a^=o<<1,o=(u>>>8^a)&16711935,a^=o,u^=o<<8,o=(u>>>2^a)&858993459,a^=o,u^=o<<2,o=(a>>>16^u)&65535,u^=o,a^=o<<16,o=(a>>>4^u)&252645135,u^=o,a^=o<<4,r[0]=a,r[1]=u}function Pi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=st.cipher.createDecipher(r,e.key):n=st.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof st.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var lr=U((Cm,bu)=>{var Di=J();bu.exports=Di.md=Di.md||{};Di.md.algorithms=Di.md.algorithms||{}});var Su=U((Im,wu)=>{var Re=J();lr();yt();var ip=wu.exports=Re.hmac=Re.hmac||{};ip.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Re.md.algorithms)t=Re.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(o===null)o=e;else{if(typeof o=="string")o=Re.util.createBuffer(o);else if(Re.util.isArray(o)){var a=o;o=Re.util.createBuffer();for(var u=0;u<a.length;++u)o.putByte(a[u])}var f=o.length();f>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=Re.util.createBuffer(),n=Re.util.createBuffer(),f=o.length();for(var u=0;u<f;++u){var a=o.at(u);r.putByte(54^a),n.putByte(92^a)}if(f<t.blockLength)for(var a=t.blockLength-f,u=0;u<a;++u)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var Or=U(()=>{});var Eo=U((Rm,Eu)=>{var Kt=J();Su();lr();yt();var sp=Kt.pkcs5=Kt.pkcs5||{},Ne;Kt.util.isNodejs&&!Kt.options.usePureJavaScript&&(Ne=Or());Eu.exports=Kt.pbkdf2=sp.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Kt.util.isNodejs&&!Kt.options.usePureJavaScript&&Ne.pbkdf2&&(i===null||typeof i!="object")&&(Ne.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Ne.pbkdf2Sync.length===4?Ne.pbkdf2(e,t,r,n,function(A,P){if(A)return s(A);s(null,P.toString("binary"))}):Ne.pbkdf2(e,t,r,n,i,function(A,P){if(A)return s(A);s(null,P.toString("binary"))}):Ne.pbkdf2Sync.length===4?Ne.pbkdf2Sync(e,t,r,n).toString("binary"):Ne.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Kt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Kt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var u=Math.ceil(n/o),f=n-(u-1)*o,c=Kt.hmac.create();c.start(i,e);var h="",l,d,p;if(!s){for(var y=1;y<=u;++y){c.start(null,null),c.update(t),c.update(Kt.util.int32ToBytes(y)),l=p=c.digest().getBytes();for(var x=2;x<=r;++x)c.start(null,null),c.update(p),d=c.digest().getBytes(),l=Kt.util.xorBytes(l,d,o),p=d;h+=y<u?l:l.substr(0,f)}return h}var y=1,x;function v(){if(y>u)return s(null,h);c.start(null,null),c.update(t),c.update(Kt.util.int32ToBytes(y)),l=p=c.digest().getBytes(),x=2,w()}function w(){if(x<=r)return c.start(null,null),c.update(p),d=c.digest().getBytes(),l=Kt.util.xorBytes(l,d,o),p=d,++x,Kt.util.setImmediate(w);h+=y<u?l:l.substr(0,f),++y,v()}v()}});var Cu=U((Nm,Au)=>{var Ui=J();yt();var Bu=Au.exports=Ui.pem=Ui.pem||{};Bu.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=ki(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=ki(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=ki(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=ki(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Ui.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Bu.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ui.util.decode64(s[3])};if(t.push(a),!!s[2]){for(var u=s[2].split(i),f=0;s&&f<u.length;){for(var c=u[f].replace(/\s+$/,""),h=f+1;h<u.length;++h){var l=u[h];if(!/\s/.test(l[0]))break;c+=l,f=h}if(s=c.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)d.values.push(op(p[y]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function ki(e){for(var t=e.name+": ",r=[],n=function(u,f){return" "+f},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),s=i-o-1,o=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(o=i);return t}function op(e){return e.replace(/^\s+/,"")}});var Lu=U((Lm,Nu)=>{var me=J();lr();yt();var _u=Nu.exports=me.sha256=me.sha256||{};me.md.sha256=me.md.algorithms.sha256=_u;_u.create=function(){Tu||ap();var e=null,t=me.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=me.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=me.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),Iu(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=me.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Bo.substr(0,n.blockLength-o));for(var a,u,f=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,u=a/4294967296>>>0,f+=u,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Iu(h,r,i);var l=me.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Bo=null,Tu=!1,Ru=null;function ap(){Bo=String.fromCharCode(128),Bo+=me.util.fillString(String.fromCharCode(0),64),Ru=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Tu=!0}function Iu(e,t,r){for(var n,i,s,o,a,u,f,c,h,l,d,p,y,x,v,w=r.length();w>=64;){for(f=0;f<16;++f)t[f]=r.getInt32();for(;f<64;++f)n=t[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[f]=n+t[f-7]+i+t[f-16]|0;for(c=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,y=e.h5,x=e.h6,v=e.h7,f=0;f<64;++f)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=x^p&(y^x),s=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),u=c&h|l&(c^h),n=v+o+a+Ru[f]+t[f],i=s+u,v=x,x=y,y=p,p=d+n>>>0,d=l,l=h,h=c,c=n+i>>>0;e.h0=e.h0+c|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+x|0,e.h7=e.h7+v|0,w-=64}}});var Du=U((Pm,Pu)=>{var xe=J();yt();var Ki=null;xe.util.isNodejs&&!xe.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ki=Or());var up=Pu.exports=xe.prng=xe.prng||{};up.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(f,c){if(!c)return t.generateSync(f);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,y=xe.util.createBuffer();t.key=null,x();function x(v){if(v)return c(v);if(y.length()>=f)return c(null,y.getBytes(f));if(t.generated>1048575&&(t.key=null),t.key===null)return xe.util.nextTick(function(){s(x)});var w=h(t.key,t.seed);t.generated+=w.length,y.putBytes(w),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),xe.util.setImmediate(x)}},t.generateSync=function(f){var c=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=xe.util.createBuffer();p.length()<f;){t.generated>1048575&&(t.key=null),t.key===null&&o();var y=c(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=l(c(t.key,h(t.seed))),t.seed=d(c(t.key,t.seed))}return p.getBytes(f)};function s(f){if(t.pools[0].messageLength>=32)return a(),f();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(h,l){if(h)return f(h);t.collect(l),a(),f()})}function o(){if(t.pools[0].messageLength>=32)return a();var f=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(f)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var f=t.plugin.md.create();f.update(t.keyBytes);for(var c=1,h=0;h<32;++h)t.reseeds%c===0&&(f.update(t.pools[h].digest().getBytes()),t.pools[h].start()),c=c<<1;t.keyBytes=f.digest().getBytes(),f.start(),f.update(t.keyBytes);var l=f.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function u(f){var c=null,h=xe.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(C){return l.getRandomValues(C)});var d=xe.util.createBuffer();if(c)for(;d.length()<f;){var p=Math.max(1,Math.min(f-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{c(y);for(var x=0;x<y.length;++x)d.putInt32(y[x])}catch(C){if(!(typeof QuotaExceededError<"u"&&C instanceof QuotaExceededError))throw C}}if(d.length()<f)for(var v,w,A,P=Math.floor(Math.random()*65536);d.length()<f;){w=16807*(P&65535),v=16807*(P>>16),w+=(v&32767)<<16,w+=v>>15,w=(w&2147483647)+(w>>31),P=w&4294967295;for(var x=0;x<3;++x)A=P>>>(x<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(f)}return Ki?(t.seedFile=function(f,c){Ki.randomBytes(f,function(h,l){if(h)return c(h);c(null,l.toString())})},t.seedFileSync=function(f){return Ki.randomBytes(f).toString()}):(t.seedFile=function(f,c){try{c(null,u(f))}catch(h){c(h)}},t.seedFileSync=u),t.collect=function(f){for(var c=f.length,h=0;h<c;++h)t.pools[t.pool].update(f.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(f,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(f>>l&255);t.collect(h)},t.registerWorker=function(f){if(f===self)t.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){f.postMessage({forge:{prng:{err:d,bytes:p}}})})};f.addEventListener("message",c)}},t}});var Rn=U((Dm,Ao)=>{var _t=J();bi();Lu();Du();yt();(function(){if(_t.random&&_t.random.getBytes){Ao.exports=_t.random;return}(function(e){var t={},r=new Array(4),n=_t.util.createBuffer();t.formatKey=function(h){var l=_t.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),_t.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=_t.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return _t.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=_t.md.sha256;function i(){var h=_t.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=_t.util.globalScope,u=a.crypto||a.msCrypto;if(u&&u.getRandomValues&&(o=function(h){return u.getRandomValues(h)}),_t.options.usePureJavaScript||!_t.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var c in navigator)try{typeof navigator[c]=="string"&&(f+=navigator[c])}catch{}s.collect(f),f=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!_t.random)_t.random=s;else for(var c in s)_t.random[c]=s[c];_t.random.createInstance=i,Ao.exports=_t.random})(typeof jQuery<"u"?jQuery:null)})()});var Fu=U((km,Ku)=>{var Ot=J();yt();var Co=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],ku=[1,2,3,5],fp=function(e,t){return e<<t&65535|(e&65535)>>16-t},cp=function(e,t){return(e&65535)>>t|e<<16-t&65535};Ku.exports=Ot.rc2=Ot.rc2||{};Ot.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Ot.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Co[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Co[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Co[r.at(a+1)^r.at(a+s)]);return r};var Uu=function(e,t,r){var n=!1,i=null,s=null,o=null,a,u,f,c,h=[];for(e=Ot.rc2.expandKey(e,t),f=0;f<64;f++)h.push(e.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[c]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=fp(p[f],ku[f]),c++},u=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=cp(p[f],ku[f]),p[f]-=h[c]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),c--},u=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var y=[];for(f=0;f<4;f++){var x=i.getInt16Le();o!==null&&(r?x^=o.getInt16Le():o.putInt16Le(x)),y.push(x&65535)}c=r?0:63;for(var v=0;v<p.length;v++)for(var w=0;w<p[v][0];w++)p[v][1](y);for(f=0;f<4;f++)o!==null&&(r?o.putInt16Le(y[f]):y[f]^=o.getInt16Le()),s.putInt16Le(y[f])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=Ot.util.createBuffer(p)),n=!1,i=Ot.util.createBuffer(),s=y||new Ot.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,u],[6,a],[1,u],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var v=s.length(),w=s.at(v-1);w>v?y=!1:s.truncate(w)}return y}},d};Ot.rc2.startEncrypting=function(e,t,r){var n=Ot.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Ot.rc2.createEncryptionCipher=function(e,t){return Uu(e,t,!0)};Ot.rc2.startDecrypting=function(e,t,r){var n=Ot.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Ot.rc2.createDecryptionCipher=function(e,t){return Uu(e,t,!1)}});var Oi=U((Um,Wu)=>{var Io=J();Wu.exports=Io.jsbn=Io.jsbn||{};var Le,hp=0xdeadbeefcafe,Mu=(hp&16777215)==15715070;function S(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Io.jsbn.BigInteger=S;function $(){return new S(null)}function lp(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function pp(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var u=this.data[e]&32767,f=this.data[e++]>>15,c=a*u+f*o;u=o*u+((c&32767)<<15)+r.data[n]+(i&1073741823),i=(u>>>30)+(c>>>15)+a*f+(i>>>30),r.data[n++]=u&1073741823}return i}function Ou(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var u=this.data[e]&16383,f=this.data[e++]>>14,c=a*u+f*o;u=o*u+((c&16383)<<14)+r.data[n]+i,i=(u>>28)+(c>>14)+a*f,r.data[n++]=u&268435455}return i}typeof navigator>"u"?(S.prototype.am=Ou,Le=28):Mu&&navigator.appName=="Microsoft Internet Explorer"?(S.prototype.am=pp,Le=30):Mu&&navigator.appName!="Netscape"?(S.prototype.am=lp,Le=26):(S.prototype.am=Ou,Le=28);S.prototype.DB=Le;S.prototype.DM=(1<<Le)-1;S.prototype.DV=1<<Le;var _o=52;S.prototype.FV=Math.pow(2,_o);S.prototype.F1=_o-Le;S.prototype.F2=2*Le-_o;var dp="0123456789abcdefghijklmnopqrstuvwxyz",Fi=new Array,Vr,Xt;Vr="0".charCodeAt(0);for(Xt=0;Xt<=9;++Xt)Fi[Vr++]=Xt;Vr="a".charCodeAt(0);for(Xt=10;Xt<36;++Xt)Fi[Vr++]=Xt;Vr="A".charCodeAt(0);for(Xt=10;Xt<36;++Xt)Fi[Vr++]=Xt;function Vu(e){return dp.charAt(e)}function qu(e,t){var r=Fi[e.charCodeAt(t)];return r??-1}function yp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function gp(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function We(e){var t=$();return t.fromInt(e),t}function mp(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:qu(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&S.ZERO.subTo(this,this)}function xp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function vp(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Vu(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Vu(n));return i?s:"0"}function bp(){var e=$();return S.ZERO.subTo(this,e),e}function wp(){return this.s<0?this.negate():this}function Sp(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Mi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Ep(){return this.t<=0?0:this.DB*(this.t-1)+Mi(this.data[this.t-1]^this.s&this.DM)}function Bp(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function Ap(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Cp(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)t.data[a]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Ip(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function _p(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function Tp(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&S.ZERO.subTo(t,t)}function Rp(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Np(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=$());var s=$(),o=this.s,a=e.s,u=this.DB-Mi(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var f=s.t,c=s.data[f-1];if(c!=0){var h=c*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,x=y-f,v=t??$();for(s.dlShiftTo(x,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),S.ONE.dlShiftTo(f,v),v.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--x>=0;){var w=r.data[--y]==c?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,w,r,x,0,f))<w)for(s.dlShiftTo(x,v),r.subTo(v,r);r.data[y]<--w;)r.subTo(v,r)}t!=null&&(r.drShiftTo(f,t),o!=a&&S.ZERO.subTo(t,t)),r.t=f,r.clamp(),u>0&&r.rShiftTo(u,r),o<0&&S.ZERO.subTo(r,r)}}}function Lp(e){var t=$();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(S.ZERO)>0&&e.subTo(t,t),t}function pr(e){this.m=e}function Pp(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Dp(e){return e}function kp(e){e.divRemTo(this.m,null,e)}function Up(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Kp(e,t){e.squareTo(t),this.reduce(t)}pr.prototype.convert=Pp;pr.prototype.revert=Dp;pr.prototype.reduce=kp;pr.prototype.mulTo=Up;pr.prototype.sqrTo=Kp;function Fp(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function dr(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Mp(e){var t=$();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(S.ZERO)>0&&this.m.subTo(t,t),t}function Op(e){var t=$();return e.copyTo(t),this.reduce(t),t}function Vp(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function qp(e,t){e.squareTo(t),this.reduce(t)}function zp(e,t,r){e.multiplyTo(t,r),this.reduce(r)}dr.prototype.convert=Mp;dr.prototype.revert=Op;dr.prototype.reduce=Vp;dr.prototype.mulTo=zp;dr.prototype.sqrTo=qp;function Hp(){return(this.t>0?this.data[0]&1:this.s)==0}function Gp(e,t){if(e>4294967295||e<1)return S.ONE;var r=$(),n=$(),i=t.convert(this),s=Mi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function Wp(e,t){var r;return e<256||t.isEven()?r=new pr(t):r=new dr(t),this.exp(e,r)}S.prototype.copyTo=yp;S.prototype.fromInt=gp;S.prototype.fromString=mp;S.prototype.clamp=xp;S.prototype.dlShiftTo=Bp;S.prototype.drShiftTo=Ap;S.prototype.lShiftTo=Cp;S.prototype.rShiftTo=Ip;S.prototype.subTo=_p;S.prototype.multiplyTo=Tp;S.prototype.squareTo=Rp;S.prototype.divRemTo=Np;S.prototype.invDigit=Fp;S.prototype.isEven=Hp;S.prototype.exp=Gp;S.prototype.toString=vp;S.prototype.negate=bp;S.prototype.abs=wp;S.prototype.compareTo=Sp;S.prototype.bitLength=Ep;S.prototype.mod=Lp;S.prototype.modPowInt=Wp;S.ZERO=We(0);S.ONE=We(1);function Qp(){var e=$();return this.copyTo(e),e}function $p(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Yp(){return this.t==0?this.s:this.data[0]<<24>>24}function Zp(){return this.t==0?this.s:this.data[0]<<16>>16}function Xp(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Jp(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function jp(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=We(r),i=$(),s=$(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function td(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var u=qu(e,a);if(u<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&S.ZERO.subTo(this,this)}function ed(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(S.ONE.shiftLeft(e-1),To,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(S.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function rd(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function nd(e){return this.compareTo(e)==0}function id(e){return this.compareTo(e)<0?this:e}function sd(e){return this.compareTo(e)>0?this:e}function od(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function ad(e,t){return e&t}function ud(e){var t=$();return this.bitwiseTo(e,ad,t),t}function To(e,t){return e|t}function fd(e){var t=$();return this.bitwiseTo(e,To,t),t}function zu(e,t){return e^t}function cd(e){var t=$();return this.bitwiseTo(e,zu,t),t}function Hu(e,t){return e&~t}function hd(e){var t=$();return this.bitwiseTo(e,Hu,t),t}function ld(){for(var e=$(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function pd(e){var t=$();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function dd(e){var t=$();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function yd(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function gd(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+yd(this.data[e]);return this.s<0?this.t*this.DB:-1}function md(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function xd(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=md(this.data[r]^t);return e}function vd(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function bd(e,t){var r=S.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function wd(e){return this.changeBit(e,To)}function Sd(e){return this.changeBit(e,Hu)}function Ed(e){return this.changeBit(e,zu)}function Bd(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Ad(e){var t=$();return this.addTo(e,t),t}function Cd(e){var t=$();return this.subTo(e,t),t}function Id(e){var t=$();return this.multiplyTo(e,t),t}function _d(e){var t=$();return this.divRemTo(e,t,null),t}function Td(e){var t=$();return this.divRemTo(e,null,t),t}function Rd(e){var t=$(),r=$();return this.divRemTo(e,t,r),new Array(t,r)}function Nd(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Ld(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Nn(){}function Gu(e){return e}function Pd(e,t,r){e.multiplyTo(t,r)}function Dd(e,t){e.squareTo(t)}Nn.prototype.convert=Gu;Nn.prototype.revert=Gu;Nn.prototype.mulTo=Pd;Nn.prototype.sqrTo=Dd;function kd(e){return this.exp(e,new Nn)}function Ud(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Kd(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function qr(e){this.r2=$(),this.q3=$(),S.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Fd(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=$();return e.copyTo(t),this.reduce(t),t}function Md(e){return e}function Od(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Vd(e,t){e.squareTo(t),this.reduce(t)}function qd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}qr.prototype.convert=Fd;qr.prototype.revert=Md;qr.prototype.reduce=Od;qr.prototype.mulTo=qd;qr.prototype.sqrTo=Vd;function zd(e,t){var r=e.bitLength(),n,i=We(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new pr(t):t.isEven()?s=new qr(t):s=new dr(t);var o=new Array,a=3,u=n-1,f=(1<<n)-1;if(o[1]=s.convert(this),n>1){var c=$();for(s.sqrTo(o[1],c);a<=f;)o[a]=$(),s.mulTo(c,o[a-2],o[a]),a+=2}var h=e.t-1,l,d=!0,p=$(),y;for(r=Mi(e.data[h])-1;h>=0;){for(r>=u?l=e.data[h]>>r-u&f:(l=(e.data[h]&(1<<r+1)-1)<<u-r,h>0&&(l|=e.data[h-1]>>this.DB+r-u)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function Hd(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Gd(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Wd(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return S.ZERO;for(var r=e.clone(),n=this.clone(),i=We(1),s=We(0),o=We(0),a=We(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(S.ONE)!=0)return S.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var ae=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Qd=(1<<26)/ae[ae.length-1];function $d(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=ae[ae.length-1]){for(t=0;t<ae.length;++t)if(r.data[0]==ae[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<ae.length;){for(var n=ae[t],i=t+1;i<ae.length&&n<Qd;)n*=ae[i++];for(n=r.modInt(n);t<i;)if(n%ae[t++]==0)return!1}return r.millerRabin(e)}function Yd(e){var t=this.subtract(S.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Zd(),s,o=0;o<e;++o){do s=new S(this.bitLength(),i);while(s.compareTo(S.ONE)<=0||s.compareTo(t)>=0);var a=s.modPow(n,this);if(a.compareTo(S.ONE)!=0&&a.compareTo(t)!=0){for(var u=1;u++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(S.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function Zd(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}S.prototype.chunkSize=Xp;S.prototype.toRadix=jp;S.prototype.fromRadix=td;S.prototype.fromNumber=ed;S.prototype.bitwiseTo=od;S.prototype.changeBit=bd;S.prototype.addTo=Bd;S.prototype.dMultiply=Nd;S.prototype.dAddOffset=Ld;S.prototype.multiplyLowerTo=Ud;S.prototype.multiplyUpperTo=Kd;S.prototype.modInt=Gd;S.prototype.millerRabin=Yd;S.prototype.clone=Qp;S.prototype.intValue=$p;S.prototype.byteValue=Yp;S.prototype.shortValue=Zp;S.prototype.signum=Jp;S.prototype.toByteArray=rd;S.prototype.equals=nd;S.prototype.min=id;S.prototype.max=sd;S.prototype.and=ud;S.prototype.or=fd;S.prototype.xor=cd;S.prototype.andNot=hd;S.prototype.not=ld;S.prototype.shiftLeft=pd;S.prototype.shiftRight=dd;S.prototype.getLowestSetBit=gd;S.prototype.bitCount=xd;S.prototype.testBit=vd;S.prototype.setBit=wd;S.prototype.clearBit=Sd;S.prototype.flipBit=Ed;S.prototype.add=Ad;S.prototype.subtract=Cd;S.prototype.multiply=Id;S.prototype.divide=_d;S.prototype.remainder=Td;S.prototype.divideAndRemainder=Rd;S.prototype.modPow=zd;S.prototype.modInverse=Wd;S.prototype.pow=kd;S.prototype.gcd=Hd;S.prototype.isProbablePrime=$d});var Xu=U((Km,Zu)=>{var ve=J();lr();yt();var $u=Zu.exports=ve.sha1=ve.sha1||{};ve.md.sha1=ve.md.algorithms.sha1=$u;$u.create=function(){Yu||Xd();var e=null,t=ve.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=ve.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ve.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),Qu(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ve.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Ro.substr(0,n.blockLength-o));for(var a,u,f=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,u=a/4294967296>>>0,f+=u,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};Qu(h,r,i);var l=ve.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Ro=null,Yu=!1;function Xd(){Ro=String.fromCharCode(128),Ro+=ve.util.fillString(String.fromCharCode(0),64),Yu=!0}function Qu(e,t,r){for(var n,i,s,o,a,u,f,c,h=r.length();h>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+u+1518500249+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<20;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+u+1518500249+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<32;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,f=s^o^a,n=(i<<5|i>>>27)+f+u+1859775393+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<40;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=s^o^a,n=(i<<5|i>>>27)+f+u+1859775393+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<60;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=s&o|a&(s^o),n=(i<<5|i>>>27)+f+u+2400959708+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<80;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=s^o^a,n=(i<<5|i>>>27)+f+u+3395469782+n,u=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+u|0,h-=64}}});var tf=U((Fm,ju)=>{var be=J();yt();Rn();Xu();var Ju=ju.exports=be.pkcs1=be.pkcs1||{};Ju.encode_rsa_oaep=function(e,t,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=be.md.sha1.create(),o||(o=s);var a=Math.ceil(e.n.bitLength()/8),u=a-2*s.digestLength-2;if(t.length>u){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=t.length,f.maxLength=u,f}n||(n=""),s.update(n,"raw");for(var c=s.digest(),h="",l=u-t.length,d=0;d<l;d++)h+="\0";var p=c.getBytes()+h+""+t;if(!i)i=be.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=s.digestLength,f}var y=Vi(i,a-s.digestLength-1,o),x=be.util.xorBytes(p,y,p.length),v=Vi(x,s.digestLength,o),w=be.util.xorBytes(i,v,i.length);return"\0"+w+x};Ju.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=t.length,x.expectedLength=o,x}if(i===void 0?i=be.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),u=t.charAt(0),f=t.substring(1,i.digestLength+1),c=t.substring(1+i.digestLength),h=Vi(c,i.digestLength,s),l=be.util.xorBytes(f,h,f.length),d=Vi(l,o-i.digestLength-1,s),p=be.util.xorBytes(c,d,c.length),y=p.substring(0,i.digestLength),x=u!=="\0",v=0;v<i.digestLength;++v)x|=a.charAt(v)!==y.charAt(v);for(var w=1,A=i.digestLength,P=i.digestLength;P<p.length;P++){var C=p.charCodeAt(P),_=C&1^1,V=w?65534:0;x|=C&V,w=w&_,A+=w}if(x||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Vi(e,t,r){r||(r=be.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}});var ef=U((Mm,No)=>{var Qe=J();yt();Oi();Rn();(function(){if(Qe.prime){No.exports=Qe.prime;return}var e=No.exports=Qe.prime=Qe.prime||{},t=Qe.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||Qe.random,x={nextBytes:function(v){for(var w=y.getBytesSync(v.length),A=0;A<v.length;++A)v[A]=w.charCodeAt(A)}};if(p.name==="PRIMEINC")return s(h,x,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?u(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var y=f(h,l),x=0,v=c(y.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var w=10;"maxBlockTime"in d&&(w=d.maxBlockTime),a(y,h,l,x,v,w,p)}function a(h,l,d,p,y,x,v){var w=+new Date;do{if(h.bitLength()>l&&(h=f(l,d)),h.isProbablePrime(y))return v(null,h);h.dAddOffset(r[p++%8],0)}while(x<0||+new Date-w<x);Qe.util.setImmediate(function(){a(h,l,d,p,y,x,v)})}function u(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var y=f(h,l),x=d.workers,v=d.workLoad||100,w=v*30/8,A=d.workerScript||"forge/prime.worker.js";if(x===-1)return Qe.util.estimateCores(function(C,_){C&&(_=2),x=_-1,P()});P();function P(){x=Math.max(1,x);for(var C=[],_=0;_<x;++_)C[_]=new Worker(A);for(var V=x,_=0;_<x;++_)C[_].addEventListener("message",wt);var q=!1;function wt(te){if(!q){--V;var qt=te.data;if(qt.found){for(var Dt=0;Dt<C.length;++Dt)C[Dt].terminate();return q=!0,p(null,new t(qt.prime,16))}y.bitLength()>h&&(y=f(h,l));var Sr=y.toString(16);te.target.postMessage({hex:Sr,workLoad:v}),y.dAddOffset(w,0)}}}}function f(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var zi=U((Om,ff)=>{var D=J();Tn();Oi();Ni();tf();ef();Rn();yt();typeof z>"u"&&(z=D.jsbn.BigInteger);var z,Lo=D.util.isNodejs?Or():null,m=D.asn1,Jt=D.util;D.pki=D.pki||{};ff.exports=D.pki.rsa=D.rsa=D.rsa||{};var K=D.pki,Jd=[6,4,2,4,2,4,6,2],jd={name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},ty={name:"RSAPrivateKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},ey={name:"RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ry=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},ny={name:"DigestInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},iy=function(e){var t;if(e.algorithm in K.oids)t=K.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=m.oidToDer(t).getBytes(),i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]),s=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]);s.value.push(m.create(m.Class.UNIVERSAL,m.Type.OID,!1,n)),s.value.push(m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,""));var o=m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),m.toDer(i).getBytes()},af=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(z.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(z.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new z(D.util.bytesToHex(D.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(z.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var o=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o};K.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=uf(e,t,r)):(i=D.util.createBuffer(),i.putBytes(e));for(var o=new z(i.toHex(),16),a=af(o,t,n),u=a.toString(16),f=D.util.createBuffer(),c=s-Math.ceil(u.length/2);c>0;)f.putByte(0),--c;return f.putBytes(D.util.hexToBytes(u)),f.getBytes()};K.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var o=new z(D.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=af(o,t,r),u=a.toString(16),f=D.util.createBuffer(),c=i-Math.ceil(u.length/2);c>0;)f.putByte(0),--c;return f.putBytes(D.util.hexToBytes(u)),n!==!1?qi(f.getBytes(),t,r):f.getBytes()};K.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(a){for(var u=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=u.charCodeAt(f)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new z(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};K.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new z(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var u=e.p===null?e.pBits:e.qBits,f=u-1;e.pqState===0?(e.num=new z(u,e.rng),e.num.testBit(f)||e.num.bitwiseTo(z.ONE.shiftLeft(f),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(oy(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Jd[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(z.ONE).gcd(e.e).compareTo(z.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(z.ONE),e.q1=e.q.subtract(z.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(z.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-s,s=o}return e.keys!==null};K.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(rf("generateKeyPair"))return Lo.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,u,f){if(a)return n(a);n(null,{privateKey:K.privateKeyFromPem(f),publicKey:K.publicKeyFromPem(u)})});if(nf("generateKey")&&nf("exportKey"))return Jt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:of(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Jt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var u=K.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(a)));n(null,{privateKey:u,publicKey:K.setRsaPublicKey(u.n,u.e)})}});if(sf("generateKey")&&sf("exportKey")){var i=Jt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:of(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var u=a.target.result,f=Jt.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);f.oncomplete=function(c){var h=c.target.result,l=K.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(h)));n(null,{privateKey:l,publicKey:K.setRsaPublicKey(l.n,l.e)})},f.onerror=function(c){n(c)}},i.onerror=function(a){n(a)};return}}else if(rf("generateKeyPairSync")){var s=Lo.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:K.privateKeyFromPem(s.privateKey),publicKey:K.publicKeyFromPem(s.publicKey)}}}var o=K.rsa.createKeyPairGenerationState(e,t,r);if(!n)return K.rsa.stepKeyPairGenerationState(o,0),o.keys;sy(o,r,n)};K.setRsaPublicKey=K.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,u,f){return uf(a,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,u){return D.pkcs1.encode_rsa_oaep(u,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return K.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(u,f){f=qi(f,r,!0);var c=m.fromDer(f,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!m.validate(c,ny,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=m.derToOid(h.algorithmIdentifier);if(!(p===D.oids.md2||p===D.oids.md5||p===D.oids.sha1||p===D.oids.sha224||p===D.oids.sha256||p===D.oids.sha384||p===D.oids.sha512||p===D.oids["sha512-224"]||p===D.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===D.oids.md2||p===D.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(u,f){return f=qi(f,r,!0),u===f}});var a=K.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};K.setRsaPrivateKey=K.rsa.setPrivateKey=function(e,t,r,n,i,s,o,a){var u={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return u.decrypt=function(f,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=K.rsa.decrypt(f,u,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:qi};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(d,p){return D.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,u,!1)},u.sign=function(f,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:iy},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return f}},h=1);var l=c.encode(f,u.n.bitLength());return K.rsa.encrypt(l,u,h)},u};K.wrapRsaPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(K.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,m.toDer(e).getBytes())])};K.privateKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,jd,t,r)&&(e=m.fromDer(D.util.createBuffer(t.privateKey))),t={},r=[],!m.validate(e,ty,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,u,f,c,h;return i=D.util.createBuffer(t.privateKeyModulus).toHex(),s=D.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=D.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=D.util.createBuffer(t.privateKeyPrime1).toHex(),u=D.util.createBuffer(t.privateKeyPrime2).toHex(),f=D.util.createBuffer(t.privateKeyExponent1).toHex(),c=D.util.createBuffer(t.privateKeyExponent2).toHex(),h=D.util.createBuffer(t.privateKeyCoefficient).toHex(),K.setRsaPrivateKey(new z(i,16),new z(s,16),new z(o,16),new z(a,16),new z(u,16),new z(f,16),new z(c,16),new z(h,16))};K.privateKeyToAsn1=K.privateKeyToRSAPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.e)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.d)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.p)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.q)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.dP)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.dQ)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.qInv))])};K.publicKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,ry,t,r)){var n=m.derToOid(t.publicKeyOid);if(n!==K.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!m.validate(e,ey,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=D.util.createBuffer(t.publicKeyModulus).toHex(),o=D.util.createBuffer(t.publicKeyExponent).toHex();return K.setRsaPublicKey(new z(s,16),new z(o,16))};K.publicKeyToAsn1=K.publicKeyToSubjectPublicKeyInfo=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(K.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.BITSTRING,!1,[K.publicKeyToRSAPublicKey(e)])])};K.publicKeyToRSAPublicKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,we(e.e))])};function uf(e,t,r){var n=D.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var u=0;u<o;++u)n.putByte(a)}else for(;o>0;){for(var f=0,c=D.random.getBytes(o),u=0;u<o;++u)a=c.charCodeAt(u),a===0?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(e),n}function qi(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=D.util.createBuffer(e),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var u=0;if(a===0){u=i-3-n;for(var f=0;f<u;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(u=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++u}else if(a===2)for(u=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++u}var c=s.getByte();if(c!==0||u!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function sy(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(a,u){if(a)return r(a);if(e.p=u,e.q!==null)return o(a,e.q);s(e.qBits,o)})}function s(a,u){D.prime.generateProbablePrime(a,n,u)}function o(a,u){if(a)return r(a);if(e.q=u,e.p.compareTo(e.q)<0){var f=e.p;e.p=e.q,e.q=f}if(e.p.subtract(z.ONE).gcd(e.e).compareTo(z.ONE)!==0){e.p=null,i();return}if(e.q.subtract(z.ONE).gcd(e.e).compareTo(z.ONE)!==0){e.q=null,s(e.qBits,o);return}if(e.p1=e.p.subtract(z.ONE),e.q1=e.q.subtract(z.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(z.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,o);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function we(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=D.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function oy(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function rf(e){return D.util.isNodejs&&typeof Lo[e]=="function"}function nf(e){return typeof Jt.globalScope<"u"&&typeof Jt.globalScope.crypto=="object"&&typeof Jt.globalScope.crypto.subtle=="object"&&typeof Jt.globalScope.crypto.subtle[e]=="function"}function sf(e){return typeof Jt.globalScope<"u"&&typeof Jt.globalScope.msCrypto=="object"&&typeof Jt.globalScope.msCrypto.subtle=="object"&&typeof Jt.globalScope.msCrypto.subtle[e]=="function"}function of(e){for(var t=D.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var yf=U((Vm,df)=>{var T=J();bi();Tn();vu();lr();Ni();Eo();Cu();Rn();Fu();zi();yt();typeof cf>"u"&&(cf=T.jsbn.BigInteger);var cf,b=T.asn1,F=T.pki=T.pki||{};df.exports=F.pbe=T.pbe=T.pbe||{};var yr=F.oids,ay={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},uy={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},fy={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};F.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=T.random.getBytesSync(r.saltSize),i=r.count,s=b.integerToDer(i),o,a,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,c,h;switch(r.algorithm){case"aes128":o=16,f=16,c=yr["aes128-CBC"],h=T.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,c=yr["aes192-CBC"],h=T.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,c=yr["aes256-CBC"],h=T.aes.createEncryptionCipher;break;case"des":o=8,f=8,c=yr.desCBC,h=T.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=pf(d),y=T.pkcs5.pbkdf2(t,n,i,o,p),x=T.random.getBytesSync(f),v=h(y);v.start(x),v.update(b.toDer(e)),v.finish(),u=v.output.getBytes();var w=cy(n,s,o,d);a=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(yr.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(yr.pkcs5PBKDF2).getBytes()),w]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){o=24;var A=new T.util.ByteBuffer(n),y=F.pbe.generatePkcs12Key(t,A,1,i,o),x=F.pbe.generatePkcs12Key(t,A,2,i,o),v=T.des.createEncryptionCipher(y);v.start(x),v.update(b.toDer(e)),v.finish(),u=v.output.getBytes(),a=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(yr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var P=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[a,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,u)]);return P};F.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!b.validate(e,ay,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=b.derToOid(n.encryptionOid),a=F.pbe.getCipher(o,n.encryptionParams,t),u=T.util.createBuffer(n.encryptedData);return a.update(u),a.finish()&&(r=b.fromDer(a.output)),r};F.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(e).getBytes()};return T.pem.encode(r,{maxline:t})};F.encryptedPrivateKeyFromPem=function(e){var t=T.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(t.body)};F.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=F.wrapRsaPrivateKey(F.privateKeyToAsn1(e));return n=F.encryptPrivateKeyInfo(n,t,r),F.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=T.random.getBytesSync(16),a=T.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=T.random.getBytesSync(16),a=T.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=T.random.getBytesSync(16),a=T.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=T.random.getBytesSync(8),a=T.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=T.random.getBytesSync(8),a=T.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var f=T.pbe.opensslDeriveBytes(t,s.substr(0,8),o),c=a(f);c.start(s),c.update(b.toDer(F.privateKeyToAsn1(e))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:T.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return T.pem.encode(h)};F.decryptRsaPrivateKey=function(e,t){var r=null,n=T.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=T.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=T.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=T.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=T.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=T.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return T.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return T.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return T.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=T.util.hexToBytes(n.dekInfo.parameters),u=T.pbe.opensslDeriveBytes(t,a.substr(0,8),s),f=o(u);if(f.start(a),f.update(T.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=F.decryptPrivateKeyInfo(b.fromDer(r),t):r=b.fromDer(r),r!==null&&(r=F.privateKeyFromAsn1(r)),r};F.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in T.md))throw new Error('"sha1" hash algorithm unavailable.');s=T.md.sha1.create()}var u=s.digestLength,f=s.blockLength,c=new T.util.ByteBuffer,h=new T.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=t.length(),p=new T.util.ByteBuffer;p.fillWithByte(r,f);var y=f*Math.ceil(d/f),x=new T.util.ByteBuffer;for(a=0;a<y;a++)x.putByte(t.at(a%d));var v=f*Math.ceil(l/f),w=new T.util.ByteBuffer;for(a=0;a<v;a++)w.putByte(h.at(a%l));var A=x;A.putBuffer(w);for(var P=Math.ceil(i/u),C=1;C<=P;C++){var _=new T.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var V=0;V<n;V++)s.start(),s.update(_.getBytes()),_=s.digest();var q=new T.util.ByteBuffer;for(a=0;a<f;a++)q.putByte(_.at(a%u));var wt=Math.ceil(d/f)+Math.ceil(l/f),te=new T.util.ByteBuffer;for(o=0;o<wt;o++){var qt=new T.util.ByteBuffer(A.getBytes(f)),Dt=511;for(a=q.length()-1;a>=0;a--)Dt=Dt>>8,Dt+=q.at(a)+qt.at(a),qt.setAt(a,Dt&255);te.putBuffer(qt)}A=te,c.putBuffer(_)}return c.truncate(c.length()-i),c};F.pbe.getCipher=function(e,t,r){switch(e){case F.oids.pkcs5PBES2:return F.pbe.getCipherForPBES2(e,t,r);case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case F.oids["pbewithSHAAnd40BitRC2-CBC"]:return F.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};F.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!b.validate(t,uy,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=b.derToOid(n.kdfOid),e!==F.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=b.derToOid(n.encOid),e!==F.oids["aes128-CBC"]&&e!==F.oids["aes192-CBC"]&&e!==F.oids["aes256-CBC"]&&e!==F.oids["des-EDE3-CBC"]&&e!==F.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=T.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var u,f;switch(F.oids[e]){case"aes128-CBC":u=16,f=T.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,f=T.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,f=T.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,f=T.des.createDecryptionCipher;break;case"desCBC":u=8,f=T.des.createDecryptionCipher;break}var c=lf(n.prfOid),h=T.pkcs5.pbkdf2(r,o,a,u,c),l=n.encIv,d=f(h);return d.start(l),d};F.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!b.validate(t,fy,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=T.util.createBuffer(n.salt),a=T.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var u,f,c;switch(e){case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,f=8,c=T.des.startDecrypting;break;case F.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,f=8,c=function(y,x){var v=T.rc2.createDecryptionCipher(y,40);return v.start(x,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=lf(n.prfOid),l=F.pbe.generatePkcs12Key(r,o,1,a,u,h);h.start();var d=F.pbe.generatePkcs12Key(r,o,2,a,f,h);return c(l,d)};F.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in T.md))throw new Error('"md5" hash algorithm unavailable.');n=T.md.md5.create()}t===null&&(t="");for(var i=[hf(n,e+t)],s=16,o=1;s<r;++o,s+=16)i.push(hf(n,i[o-1]+e+t));return i.join("").substr(0,r)};function hf(e,t){return e.start().update(t).digest().getBytes()}function lf(e){var t;if(!e)t="hmacWithSHA1";else if(t=F.oids[b.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return pf(t)}function pf(e){var t=T.md;switch(e){case"hmacWithSHA224":t=T.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function cy(e,t,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,e),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,T.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(F.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var Rf=U((cx,Tf)=>{var rt=J();lr();yt();var Ln=Tf.exports=rt.sha512=rt.sha512||{};rt.md.sha512=rt.md.algorithms.sha512=Ln;var If=rt.sha384=rt.sha512.sha384=rt.sha512.sha384||{};If.create=function(){return Ln.create("SHA-384")};rt.md.sha384=rt.md.algorithms.sha384=If;rt.sha512.sha256=rt.sha512.sha256||{create:function(){return Ln.create("SHA-512/256")}};rt.md["sha512/256"]=rt.md.algorithms["sha512/256"]=rt.sha512.sha256;rt.sha512.sha224=rt.sha512.sha224||{create:function(){return Ln.create("SHA-512/224")}};rt.md["sha512/224"]=rt.md.algorithms["sha512/224"]=rt.sha512.sha224;Ln.create=function(e){if(_f||dy(),typeof e>"u"&&(e="SHA-512"),!(e in gr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=gr[e],r=null,n=rt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var u=a.messageLengthSize/4,f=0;f<u;++f)a.fullMessageLength.push(0);n=rt.util.createBuffer(),r=new Array(t.length);for(var f=0;f<t.length;++f)r[f]=t[f].slice(0);return a},a.start(),a.update=function(u,f){f==="utf8"&&(u=rt.util.encodeUtf8(u));var c=u.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=c[1],c[1]=c[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(u),Cf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var u=rt.util.createBuffer();u.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,c=f&a.blockLength-1;u.putBytes(ko.substr(0,a.blockLength-c));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,u.putInt32(d>>>0),d=h>>>0;u.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);Cf(y,i,u);var x=rt.util.createBuffer(),v;e==="SHA-512"?v=y.length:e==="SHA-384"?v=y.length-2:v=y.length-4;for(var p=0;p<v;++p)x.putInt32(y[p][0]),(p!==v-1||e!=="SHA-512/224")&&x.putInt32(y[p][1]);return x},a};var ko=null,_f=!1,Uo=null,gr=null;function dy(){ko=String.fromCharCode(128),ko+=rt.util.fillString(String.fromCharCode(0),128),Uo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],gr={},gr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],gr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],gr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],gr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_f=!0}function Cf(e,t,r){for(var n,i,s,o,a,u,f,c,h,l,d,p,y,x,v,w,A,P,C,_,V,q,wt,te,qt,Dt,Sr,Xn,mt,Ft,k,us,fs,cs,hs,la=r.length();la>=128;){for(mt=0;mt<16;++mt)t[mt][0]=r.getInt32()>>>0,t[mt][1]=r.getInt32()>>>0;for(;mt<80;++mt)us=t[mt-2],Ft=us[0],k=us[1],n=((Ft>>>19|k<<13)^(k>>>29|Ft<<3)^Ft>>>6)>>>0,i=((Ft<<13|k>>>19)^(k<<3|Ft>>>29)^(Ft<<26|k>>>6))>>>0,cs=t[mt-15],Ft=cs[0],k=cs[1],s=((Ft>>>1|k<<31)^(Ft>>>8|k<<24)^Ft>>>7)>>>0,o=((Ft<<31|k>>>1)^(Ft<<24|k>>>8)^(Ft<<25|k>>>7))>>>0,fs=t[mt-7],hs=t[mt-16],k=i+fs[1]+o+hs[1],t[mt][0]=n+fs[0]+s+hs[0]+(k/4294967296>>>0)>>>0,t[mt][1]=k>>>0;for(y=e[0][0],x=e[0][1],v=e[1][0],w=e[1][1],A=e[2][0],P=e[2][1],C=e[3][0],_=e[3][1],V=e[4][0],q=e[4][1],wt=e[5][0],te=e[5][1],qt=e[6][0],Dt=e[6][1],Sr=e[7][0],Xn=e[7][1],mt=0;mt<80;++mt)f=((V>>>14|q<<18)^(V>>>18|q<<14)^(q>>>9|V<<23))>>>0,c=((V<<18|q>>>14)^(V<<14|q>>>18)^(q<<23|V>>>9))>>>0,h=(qt^V&(wt^qt))>>>0,l=(Dt^q&(te^Dt))>>>0,a=((y>>>28|x<<4)^(x>>>2|y<<30)^(x>>>7|y<<25))>>>0,u=((y<<4|x>>>28)^(x<<30|y>>>2)^(x<<25|y>>>7))>>>0,d=(y&v|A&(y^v))>>>0,p=(x&w|P&(x^w))>>>0,k=Xn+c+l+Uo[mt][1]+t[mt][1],n=Sr+f+h+Uo[mt][0]+t[mt][0]+(k/4294967296>>>0)>>>0,i=k>>>0,k=u+p,s=a+d+(k/4294967296>>>0)>>>0,o=k>>>0,Sr=qt,Xn=Dt,qt=wt,Dt=te,wt=V,te=q,k=_+i,V=C+n+(k/4294967296>>>0)>>>0,q=k>>>0,C=A,_=P,A=v,P=w,v=y,w=x,k=i+o,y=n+s+(k/4294967296>>>0)>>>0,x=k>>>0;k=e[0][1]+x,e[0][0]=e[0][0]+y+(k/4294967296>>>0)>>>0,e[0][1]=k>>>0,k=e[1][1]+w,e[1][0]=e[1][0]+v+(k/4294967296>>>0)>>>0,e[1][1]=k>>>0,k=e[2][1]+P,e[2][0]=e[2][0]+A+(k/4294967296>>>0)>>>0,e[2][1]=k>>>0,k=e[3][1]+_,e[3][0]=e[3][0]+C+(k/4294967296>>>0)>>>0,e[3][1]=k>>>0,k=e[4][1]+q,e[4][0]=e[4][0]+V+(k/4294967296>>>0)>>>0,e[4][1]=k>>>0,k=e[5][1]+te,e[5][0]=e[5][0]+wt+(k/4294967296>>>0)>>>0,e[5][1]=k>>>0,k=e[6][1]+Dt,e[6][0]=e[6][0]+qt+(k/4294967296>>>0)>>>0,e[6][1]=k>>>0,k=e[7][1]+Xn,e[7][0]=e[7][0]+Sr+(k/4294967296>>>0)>>>0,e[7][1]=k>>>0,la-=128}}});var Ag={};St(Ag,{PubSubBaseProtocol:()=>ha});var he=M(xa(),1);var gs={};St(gs,{base58btc:()=>Rt,base58flickr:()=>ih});function jc(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,u=e.charAt(0),f=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,x=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,y++;for(var A=(w-v)*c+1>>>0,P=new Uint8Array(A);v!==w;){for(var C=p[v],_=0,V=A-1;(C!==0||_<x)&&V!==-1;V--,_++)C+=256*P[V]>>>0,P[V]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");x=_,v++}for(var q=A-x;q!==A&&P[q]===0;)q++;for(var wt=u.repeat(y);q<A;++q)wt+=e.charAt(P[q]);return wt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var x=0,v=0;p[y]===u;)x++,y++;for(var w=(p.length-y)*f+1>>>0,A=new Uint8Array(w);p[y];){var P=r[p.charCodeAt(y)];if(P===255)return;for(var C=0,_=w-1;(P!==0||C<v)&&_!==-1;_--,C++)P+=a*A[_]>>>0,A[_]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");v=C,y++}if(p[y]!==" "){for(var V=w-v;V!==w&&A[V]===0;)V++;for(var q=new Uint8Array(x+(w-V)),wt=x;V!==w;)q[wt++]=A[V++];return q}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var th=jc,eh=th,va=eh;var Rg=new Uint8Array(0);var ba=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Ae=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var wa=e=>new TextEncoder().encode(e),Sa=e=>new TextDecoder().decode(e);var ls=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},ps=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ba(this,t)}},ds=class{constructor(t){this.decoders=t}or(t){return Ba(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ba=(e,t)=>new ds({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),ys=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ls(t,r,n),this.decoder=new ps(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Cr=({name:e,prefix:t,encode:r,decode:n})=>new ys(e,t,r,n),Ke=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=va(r,t);return Cr({prefix:e,name:t,encode:n,decode:s=>Ae(i(s))})},rh=(e,t,r,n)=>{let i={};for(let c=0;c<t.length;++c)i[t[c]]=c;let s=e.length;for(;e[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,u=0,f=0;for(let c=0;c<s;++c){let h=i[e[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},nh=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let u=0;u<e.length;++u)for(a=a<<8|e[u],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},ht=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Cr({prefix:t,name:e,encode(i){return nh(i,n,r)},decode(i){return rh(i,n,r,e)}});var Rt=Ke({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ih=Ke({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ms={};St(ms,{base32:()=>Fe,base32hex:()=>uh,base32hexpad:()=>ch,base32hexpadupper:()=>hh,base32hexupper:()=>fh,base32pad:()=>oh,base32padupper:()=>ah,base32upper:()=>sh,base32z:()=>lh});var Fe=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sh=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),oh=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ah=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),uh=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fh=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ch=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hh=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),lh=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var xs={};St(xs,{base64:()=>rr,base64pad:()=>ph,base64url:()=>dh,base64urlpad:()=>yh});var rr=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ph=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dh=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yh=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});he.default.formatters.b=e=>e==null?"undefined":Rt.baseEncode(e);he.default.formatters.t=e=>e==null?"undefined":Fe.baseEncode(e);he.default.formatters.m=e=>e==null?"undefined":rr.baseEncode(e);he.default.formatters.p=e=>e==null?"undefined":e.toString();he.default.formatters.c=e=>e==null?"undefined":e.toString();he.default.formatters.k=e=>e==null?"undefined":e.toString();function ei(e){return Object.assign((0,he.default)(e),{error:(0,he.default)(`${e}:error`),trace:(0,he.default)(`${e}:trace`)})}var nr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ce,Ir=class extends EventTarget{constructor(){super(...arguments),Ce.set(this,new Map)}listenerCount(t){let r=nr(this,Ce,"f").get(t);return r==null?0:r.length}addEventListener(t,r,n){super.addEventListener(t,r,n);let i=nr(this,Ce,"f").get(t);i==null&&(i=[],nr(this,Ce,"f").set(t,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(t,r,n){super.removeEventListener(t.toString(),r??null,n);let i=nr(this,Ce,"f").get(t);i!=null&&(i=i.filter(({callback:s})=>s!==r),nr(this,Ce,"f").set(t,i))}dispatchEvent(t){let r=super.dispatchEvent(t),n=nr(this,Ce,"f").get(t.type);return n==null||(n=n.filter(({once:i})=>!i),nr(this,Ce,"f").set(t.type,n)),r}safeDispatchEvent(t,r){return this.dispatchEvent(new le(t,r))}};Ce=new WeakMap;var vs=class extends Event{constructor(t,r){super(t,r),this.detail=r?.detail}},le=globalThis.CustomEvent??vs;var at=class extends Error{constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var ri=class{constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},_r=class{constructor(t={}){this.hwm=t.splitLimit??16,this.head=new ri(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new ri(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};function Tr(e={}){return gh(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function gh(e,t){t=t??{};let r=t.onEnd,n=new _r,i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((y,x)=>{s=v=>{s=null,n.push(v);try{y(e(n))}catch(w){x(w)}return i}}):e(n),u=y=>s!=null?s(y):(n.push(y),i),f=y=>(n=new _r,s!=null?s({error:y}):(n.push({error:y}),i)),c=y=>{if(o)return i;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:y})},h=y=>o?i:(o=!0,y!=null?f(y):u({done:!0})),l=()=>(n=new _r,h(),{done:!0}),d=y=>(h(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:c,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:c,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength}},i}async function*bs(...e){let t=Tr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async r=>{for await(let n of r)t.push(n)})),t.end()}catch(r){t.end(r)}}),yield*t}var mh=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Aa=e=>e!=null&&(typeof e[Symbol.asyncIterator]=="function"||typeof e[Symbol.iterator]=="function"||typeof e.next=="function"),ws=e=>e!=null&&typeof e.sink=="function"&&Aa(e.source),xh=e=>t=>{let r=e.sink(t);if(r.then!=null){let n=Tr({objectMode:!0});return r.then(()=>{n.end()},s=>{n.end(s)}),bs(n,async function*(){yield*e.source,n.end()}())}return e.source};function an(e,...t){if(ws(e)){let n=e;e=()=>n.source}else if(Aa(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&ws(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)ws(r[n])&&(r[n]=xh(r[n]));return mh(...r)}var Ua=M(Ia(),1);var fn=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},Es=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},_a=e=>globalThis.DOMException===void 0?new Es(e):new DOMException(e),Ta=e=>{let t=e.reason===void 0?_a("This operation was aborted."):e.reason;return t instanceof Error?t:_a(t)};function Bs(e,t,r,n){let i,s=new Promise((o,a)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){o(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:u}=n;u.aborted&&a(Ta(u)),u.addEventListener("abort",()=>{a(Ta(u))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(c){a(c)}return}let u=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,f=r instanceof Error?r:new fn(u);typeof e.cancel=="function"&&e.cancel(),a(f)},t),(async()=>{try{o(await e)}catch(u){a(u)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s}function As(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}var ir=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ie,cn=class{constructor(){Ie.set(this,[])}enqueue(t,r){r={priority:0,...r};let n={priority:r.priority,run:t};if(this.size&&ir(this,Ie,"f")[this.size-1].priority>=r.priority){ir(this,Ie,"f").push(n);return}let i=As(ir(this,Ie,"f"),n,(s,o)=>o.priority-s.priority);ir(this,Ie,"f").splice(i,0,n)}dequeue(){let t=ir(this,Ie,"f").shift();return t?.run}filter(t){return ir(this,Ie,"f").filter(r=>r.priority===t.priority).map(r=>r.run)}get size(){return ir(this,Ie,"f").length}};Ie=new WeakMap;var ut=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},N=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},pt,ln,pn,Oe,fi,dn,ii,ee,hn,Ht,si,Gt,yn,Me,oi,Ra,Na,ka,La,Pa,Da,ai,Cs,Is,ci,ui,wh=new fn,_s=class extends Error{},gn=class extends Ua.default{constructor(t){var r,n,i,s;if(super(),pt.add(this),ln.set(this,void 0),pn.set(this,void 0),Oe.set(this,0),fi.set(this,void 0),dn.set(this,void 0),ii.set(this,0),ee.set(this,void 0),hn.set(this,void 0),Ht.set(this,void 0),si.set(this,void 0),Gt.set(this,0),yn.set(this,void 0),Me.set(this,void 0),oi.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:cn,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=t.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=t.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof t.interval})`);ut(this,ln,t.carryoverConcurrencyCount,"f"),ut(this,pn,t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,"f"),ut(this,fi,t.intervalCap,"f"),ut(this,dn,t.interval,"f"),ut(this,Ht,new t.queueClass,"f"),ut(this,si,t.queueClass,"f"),this.concurrency=t.concurrency,this.timeout=t.timeout,ut(this,oi,t.throwOnTimeout===!0,"f"),ut(this,Me,t.autoStart===!1,"f")}get concurrency(){return N(this,yn,"f")}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);ut(this,yn,t,"f"),N(this,pt,"m",ci).call(this)}async add(t,r={}){return new Promise((n,i)=>{let s=async()=>{var o,a,u;ut(this,Gt,(a=N(this,Gt,"f"),a++,a),"f"),ut(this,Oe,(u=N(this,Oe,"f"),u++,u),"f");try{if(!((o=r.signal)===null||o===void 0)&&o.aborted){i(new _s("The task was aborted."));return}let c=await(this.timeout===void 0&&r.timeout===void 0?t({signal:r.signal}):Bs(Promise.resolve(t({signal:r.signal})),r.timeout===void 0?this.timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?N(this,oi,"f"):r.throwOnTimeout)&&i(wh)}));n(c),this.emit("completed",c)}catch(f){i(f),this.emit("error",f)}N(this,pt,"m",ka).call(this)};N(this,Ht,"f").enqueue(s,r),N(this,pt,"m",ai).call(this),this.emit("add")})}async addAll(t,r){return Promise.all(t.map(async n=>this.add(n,r)))}start(){return N(this,Me,"f")?(ut(this,Me,!1,"f"),N(this,pt,"m",ci).call(this),this):this}pause(){ut(this,Me,!0,"f")}clear(){ut(this,Ht,new(N(this,si,"f")),"f")}async onEmpty(){N(this,Ht,"f").size!==0&&await N(this,pt,"m",ui).call(this,"empty")}async onSizeLessThan(t){N(this,Ht,"f").size<t||await N(this,pt,"m",ui).call(this,"next",()=>N(this,Ht,"f").size<t)}async onIdle(){N(this,Gt,"f")===0&&N(this,Ht,"f").size===0||await N(this,pt,"m",ui).call(this,"idle")}get size(){return N(this,Ht,"f").size}sizeBy(t){return N(this,Ht,"f").filter(t).length}get pending(){return N(this,Gt,"f")}get isPaused(){return N(this,Me,"f")}};ln=new WeakMap,pn=new WeakMap,Oe=new WeakMap,fi=new WeakMap,dn=new WeakMap,ii=new WeakMap,ee=new WeakMap,hn=new WeakMap,Ht=new WeakMap,si=new WeakMap,Gt=new WeakMap,yn=new WeakMap,Me=new WeakMap,oi=new WeakMap,pt=new WeakSet,Ra=function(){return N(this,pn,"f")||N(this,Oe,"f")<N(this,fi,"f")},Na=function(){return N(this,Gt,"f")<N(this,yn,"f")},ka=function(){var t;ut(this,Gt,(t=N(this,Gt,"f"),t--,t),"f"),N(this,pt,"m",ai).call(this),this.emit("next")},La=function(){this.emit("empty"),N(this,Gt,"f")===0&&this.emit("idle")},Pa=function(){N(this,pt,"m",Is).call(this),N(this,pt,"m",Cs).call(this),ut(this,hn,void 0,"f")},Da=function(){let t=Date.now();if(N(this,ee,"f")===void 0){let r=N(this,ii,"f")-t;if(r<0)ut(this,Oe,N(this,ln,"f")?N(this,Gt,"f"):0,"f");else return N(this,hn,"f")===void 0&&ut(this,hn,setTimeout(()=>{N(this,pt,"m",Pa).call(this)},r),"f"),!0}return!1},ai=function(){if(N(this,Ht,"f").size===0)return N(this,ee,"f")&&clearInterval(N(this,ee,"f")),ut(this,ee,void 0,"f"),N(this,pt,"m",La).call(this),!1;if(!N(this,Me,"f")){let t=!N(this,pt,"a",Da);if(N(this,pt,"a",Ra)&&N(this,pt,"a",Na)){let r=N(this,Ht,"f").dequeue();return r?(this.emit("active"),r(),t&&N(this,pt,"m",Cs).call(this),!0):!1}}return!1},Cs=function(){N(this,pn,"f")||N(this,ee,"f")!==void 0||(ut(this,ee,setInterval(()=>{N(this,pt,"m",Is).call(this)},N(this,dn,"f")),"f"),ut(this,ii,Date.now()+N(this,dn,"f"),"f"))},Is=function(){N(this,Oe,"f")===0&&N(this,Gt,"f")===0&&N(this,ee,"f")&&(clearInterval(N(this,ee,"f")),ut(this,ee,void 0,"f")),ut(this,Oe,N(this,ln,"f")?N(this,Gt,"f"):0,"f"),N(this,pt,"m",ci).call(this)},ci=function(){for(;N(this,pt,"m",ai).call(this););},ui=async function(t,r){return new Promise(n=>{let i=()=>{r&&!r()||(this.off(t,i),n())};this.on(t,i)})};var Ts=Symbol.for("@libp2p/topology");var Ka=()=>{},Rs=class{constructor(t){this.min=t.min??0,this.max=t.max??1/0,this.peers=new Set,this.onConnect=t.onConnect??Ka,this.onDisconnect=t.onDisconnect??Ka}get[Symbol.toStringTag](){return Ts.toString()}get[Ts](){return!0}async setRegistrar(t){this.registrar=t}disconnect(t){this.onDisconnect(t)}};function Fa(e){return new Rs(e)}var Bt={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_MISSING_KEY:"ERR_MISSING_KEY",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_MISSING_FROM:"ERR_MISSING_FROM",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO",ERR_TOPIC_VALIDATOR_REJECT:"ERR_TOPIC_VALIDATOR_REJECT"};function sr(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function _e(e=0){return globalThis.Buffer?.alloc!=null?sr(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Te(e=0){return globalThis.Buffer?.allocUnsafe!=null?sr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Lt(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Te(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return sr(r)}function Pt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Oa=Symbol.for("@achingbrain/uint8arraylist");function Ma(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function hi(e){return Boolean(e?.[Oa])}var Yt=class{constructor(...t){Object.defineProperty(this,Oa,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(hi(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(hi(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Ma(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Ma(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(hi(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Lt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Lt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new Yt;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,u=a+o.byteLength;if(i=u,t>=u)continue;let f=t>=a&&t<u,c=r>a&&r<=u;if(f&&c){if(t===a&&r===u){n.push(o);break}let h=t-a;n.push(o.subarray(h,h+(r-t)));break}if(f){if(t===0){n.push(o);continue}n.push(o.subarray(t-a));continue}if(c){if(r===u){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!hi(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=-1;for(let h=0;h<i;h++)o[n[h]]=h;let a=o,u=this.byteLength-n.byteLength,f=n.byteLength-1,c;for(let h=r;h<=u;h+=c){c=0;for(let l=f;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){c=Math.max(1,l-a[d]);break}}if(c===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Te(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=_e(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=_e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=_e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Te(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=_e(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=_e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=_e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=_e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=_e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof Yt)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Pt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new Yt;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function li(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var Va=4294967296,Wt=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new Wt(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new Wt(r,n)}toBytes(t,r=0){let n=li(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new Wt;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Va&&(i=0,++n>Va&&(n=0))),new Wt(n,i)}static fromNumber(t){if(t===0)return new Wt;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Wt(i,n)}static fromBytes(t,r=0){let n=li(t),i=new Wt,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Sh=Math.pow(2,7),Eh=Math.pow(2,14),Bh=Math.pow(2,21),Ah=Math.pow(2,28),Ch=Math.pow(2,35),Ih=Math.pow(2,42),_h=Math.pow(2,49),Th=Math.pow(2,56),Rh=Math.pow(2,63),or={encodingLength(e){return e<Sh?1:e<Eh?2:e<Bh?3:e<Ah?4:e<Ch?5:e<Ih?6:e<_h?7:e<Th?8:e<Rh?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=Te(or.encodingLength(e))),Wt.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return Wt.fromBytes(e,t).toNumber(!0)}};function qa(e){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}var pi=e=>{let t=or.encodingLength(e),r=qa(t);return or.encode(e,r),pi.bytes=t,r};pi.bytes=0;function di(e){e=e??{};let t=e.lengthEncoder??pi;return async function*(n){for await(let i of n){let s=t(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}}}di.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??pi;return new Yt(r(e.byteLength),e)};var mn=M(Mt(),1),Lh=8,Ph=1024*1024*4,ar;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(ar||(ar={}));var Ns=e=>{let t=or.decode(e);return Ns.bytes=or.encodingLength(t),t};Ns.bytes=0;function xn(e){return async function*(r){let n=new Yt,i=ar.LENGTH,s=-1,o=e?.lengthDecoder??Ns,a=e?.maxLengthLength??Lh,u=e?.maxDataLength??Ph;for await(let f of r)for(n.append(f);n.byteLength>0;){if(i===ar.LENGTH)try{if(s=o(n),s<0)throw(0,mn.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>u)throw(0,mn.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let c=o.bytes;n.consume(c),e?.onLength!=null&&e.onLength(s),i=ar.DATA}catch(c){if(c instanceof RangeError){if(n.byteLength>a)throw(0,mn.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw c}if(i===ar.DATA){if(n.byteLength<s)break;let c=n.sublist(0,s);n.consume(s),e?.onData!=null&&e.onData(c),yield c,i=ar.LENGTH}}if(n.byteLength>0)throw(0,mn.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}xn.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await e.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return xn({...t??{},onLength:s=>{r=s}})(n)};var vn=class extends Error{constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Ga(e){if(e!=null){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}function Wa(e,t,r){let n=r??{},i=Ga(e);async function*s(){let o,a=()=>{o?.()};for(t.addEventListener("abort",a);;){let u;try{if(t.aborted){let{abortMessage:c,abortCode:h}=n;throw new vn(c,h)}let f=new Promise((c,h)=>{o=()=>{let{abortMessage:l,abortCode:d}=n;h(new vn(l,d))}});u=await Promise.race([f,i.next()]),o=null}catch(f){t.removeEventListener("abort",a);let c=f.type==="aborted"&&t.aborted;if(c&&n.onAbort!=null&&await n.onAbort(e),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(c&&n.returnOnAbort===!0)return;throw f}if(u.done===!0)break;yield u.value}t.removeEventListener("abort",a)}return s()}var kh=ei("libp2p-pubsub:peer-streams"),yi=class extends Ir{constructor(t){super(),this.id=t.id,this.protocol=t.protocol,this._inboundAbortController=new AbortController,this.closed=!1}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(t){if(this.outboundStream==null){let r=this.id.toString();throw new Error("No writable connection to "+r)}this.outboundStream.push(t instanceof Uint8Array?new Yt(t):t)}attachInboundStream(t){return this._rawInboundStream=t,this.inboundStream=Wa(an(this._rawInboundStream,xn()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.dispatchEvent(new le("stream:inbound")),this.inboundStream}async attachOutboundStream(t){let r=this.outboundStream;return this.outboundStream!=null&&await this.outboundStream.end(),this._rawOutboundStream=t,this.outboundStream=Tr({objectMode:!0,onEnd:n=>{this._rawOutboundStream!=null&&this._rawOutboundStream.reset!=null&&this._rawOutboundStream.reset(),this._rawOutboundStream=void 0,this.outboundStream=void 0,n!=null&&this.dispatchEvent(new le("close"))}}),an(this.outboundStream,di(),this._rawOutboundStream).catch(n=>{kh.error(n)}),r==null&&this.dispatchEvent(new le("stream:outbound")),this.outboundStream}close(){this.closed||(this.closed=!0,this.outboundStream!=null&&this.outboundStream.end(),this.inboundStream!=null&&this._inboundAbortController.abort(),this._rawOutboundStream=void 0,this.outboundStream=void 0,this._rawInboundStream=void 0,this.inboundStream=void 0,this.dispatchEvent(new le("close")))}};var dt={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Qa={SHA1:20,SHA256:32,SHA512:64};var Uh={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Kh=async(e,t)=>{let r=await dt.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(r,0,r.byteLength)};async function $a(e,t){let r=Uh[e],n=await dt.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return await Kh(n,i)},length:Qa[e]}}var O2=M(bi(),1),Pl=M(J(),1);var zs={};St(zs,{identity:()=>Gh});var Gh=Cr({prefix:"\0",name:"identity",encode:e=>Sa(e),decode:e=>wa(e)});var Hs={};St(Hs,{base2:()=>Wh});var Wh=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Gs={};St(Gs,{base8:()=>Qh});var Qh=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ws={};St(Ws,{base10:()=>$h});var $h=Ke({prefix:"9",name:"base10",alphabet:"0123456789"});var Qs={};St(Qs,{base16:()=>Yh,base16upper:()=>Zh});var Yh=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zh=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $s={};St($s,{base36:()=>Xh,base36upper:()=>Jh});var Xh=Ke({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Jh=Ke({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ys={};St(Ys,{base256emoji:()=>nl});var c0=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),jh=c0.reduce((e,t,r)=>(e[r]=t,e),[]),tl=c0.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function el(e){return e.reduce((t,r)=>(t+=jh[r],t),"")}function rl(e){let t=[];for(let r of e){let n=tl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var nl=Cr({prefix:"\u{1F680}",name:"base256emoji",encode:el,decode:rl});var js={};St(js,{sha256:()=>Et,sha512:()=>Sl});var il=p0,h0=128,sl=127,ol=~sl,al=Math.pow(2,31);function p0(e,t,r){t=t||[],r=r||0;for(var n=r;e>=al;)t[r++]=e&255|h0,e/=128;for(;e&ol;)t[r++]=e&255|h0,e>>>=7;return t[r]=e|0,p0.bytes=r-n+1,t}var ul=Zs,fl=128,l0=127;function Zs(e,n){var r=0,n=n||0,i=0,s=n,o,a=e.length;do{if(s>=a)throw Zs.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&l0)<<i:(o&l0)*Math.pow(2,i),i+=7}while(o>=fl);return Zs.bytes=s-n,r}var cl=Math.pow(2,7),hl=Math.pow(2,14),ll=Math.pow(2,21),pl=Math.pow(2,28),dl=Math.pow(2,35),yl=Math.pow(2,42),gl=Math.pow(2,49),ml=Math.pow(2,56),xl=Math.pow(2,63),vl=function(e){return e<cl?1:e<hl?2:e<ll?3:e<pl?4:e<dl?5:e<yl?6:e<gl?7:e<ml?8:e<xl?9:10},bl={encode:il,decode:ul,encodingLength:vl},wl=bl,wn=wl;var Sn=(e,t=0)=>[wn.decode(e,t),wn.decode.bytes],Lr=(e,t,r=0)=>(wn.encode(e,t,r),t),Pr=e=>wn.encodingLength(e);var pe=(e,t)=>{let r=t.byteLength,n=Pr(e),i=n+Pr(r),s=new Uint8Array(i+r);return Lr(e,s,0),Lr(r,s,n),s.set(t,i),new Dr(e,r,t,s)},En=e=>{let t=Ae(e),[r,n]=Sn(t),[i,s]=Sn(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Dr(r,i,o,t)},d0=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&ba(e.bytes,r.bytes)}},Dr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var Js=({name:e,code:t,encode:r})=>new Xs(e,t,r),Xs=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?pe(this.code,r):r.then(n=>pe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var g0=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Et=Js({name:"sha2-256",code:18,encode:g0("SHA-256")}),Sl=Js({name:"sha2-512",code:19,encode:g0("SHA-512")});var to={};St(to,{identity:()=>ze});var m0=0,El="identity",x0=Ae,Bl=e=>pe(m0,x0(e)),ze={code:m0,name:El,encode:x0,digest:Bl};var v2=new TextEncoder,b2=new TextDecoder;var v0=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return _l(r,eo(e),t||Rt.encoder);default:return Tl(r,eo(e),t||Fe.encoder)}};var b0=new WeakMap,eo=e=>{let t=b0.get(e);if(t==null){let r=new Map;return b0.set(e,r),r}return t},ft=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Bn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Rl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ft.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=pe(t,r);return ft.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return ft.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&d0(t.multihash,n.multihash)}toString(t){return v0(this,t)}toJSON(){return{"/":v0(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof ft)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new ft(n,i,s,o||w0(n,i,s.bytes))}else if(r[Nl]===!0){let{version:n,multihash:i,code:s}=r,o=En(i);return ft.create(n,s,o)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Bn)throw new Error(`Version 0 CID must use dag-pb (code: ${Bn}) block encoding`);return new ft(t,r,n,n.bytes)}case 1:{let i=w0(t,r,n.bytes);return new ft(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return ft.create(0,Bn,t)}static createV1(t,r){return ft.create(1,t,r)}static decode(t){let[r,n]=ft.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=ft.inspectBytes(t),n=r.size-r.multihashSize,i=Ae(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Dr(r.multihashCode,r.digestSize,s,i);return[r.version===0?ft.createV0(o):ft.createV1(r.codec,o),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=Sn(t.subarray(r));return r+=l,h},i=n(),s=Bn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),u=n(),f=r+u,c=f-o;return{version:i,codec:s,multihashCode:a,digestSize:u,multihashSize:c,size:f}}static parse(t,r){let[n,i]=Il(t,r),s=ft.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return eo(s).set(n,t),s}},Il=(e,t)=>{switch(e[0]){case"Q":{let r=t||Rt;return[Rt.prefix,r.decode(`${Rt.prefix}${e}`)]}case Rt.prefix:{let r=t||Rt;return[Rt.prefix,r.decode(e)]}case Fe.prefix:{let r=t||Fe;return[Fe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},_l=(e,t,r)=>{let{prefix:n}=r;if(n!==Rt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},Tl=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},Bn=112,Rl=18,w0=(e,t,r)=>{let n=Pr(e),i=n+Pr(t),s=new Uint8Array(i+r.byteLength);return Lr(e,s,0),Lr(t,s,n),s.set(r,i),s},Nl=Symbol.for("@ipld/js-cid/CID");var Ur={...zs,...Hs,...Gs,...Ws,...Qs,...ms,...$s,...gs,...xs,...Ys},R2={...js,...to};function E0(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var S0=E0("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ro=E0("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Te(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ll={utf8:S0,"utf-8":S0,hex:Ur.base16,latin1:ro,ascii:ro,binary:ro,...Ur},Si=Ll;function xt(e,t="utf8"){let r=Si[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function vt(e,t="utf8"){let r=Si[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sr(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var kl=M(Mt(),1);var Wn={};St(Wn,{generateEphemeralKeyPair:()=>Ef,generateKeyPair:()=>cg,generateKeyPairFromSeed:()=>hg,importKey:()=>yg,keyStretcher:()=>mf,keysPBM:()=>Mr,marshalPrivateKey:()=>dg,marshalPublicKey:()=>pg,supportedKeys:()=>Be,unmarshalPrivateKey:()=>Ec,unmarshalPublicKey:()=>lg});var Mr={};St(Mr,{KeyType:()=>tt,PrivateKey:()=>oe,PublicKey:()=>se});var go=M(ao(),1),cu=M(ru(),1),mo=M(yo(),1),hu=M(fu(),1),lu=M(cr(),1);function Gl(){lu.default._configure(),go.default._configure(cu.default),mo.default._configure(hu.default)}Gl();var pu=["uint64","int64","sint64","fixed64","sfixed64"];function Wl(e){for(let t of pu){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function xo(e){return Wl(new go.default(e))}function Ql(e){for(let t of pu){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function vo(){return Ql(mo.default.create())}function Ii(e,t){let r=xo(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function _i(e,t){let r=vo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var Fr;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(Fr||(Fr={}));function Ti(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function bo(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,o){let a=t(s);o.int32(a)},n=function(s){let o=s.int32();return t(o)};return Ti("enum",Fr.VARINT,r,n)}function Ri(e,t){return Ti("message",Fr.LENGTH_DELIMITED,e,t)}var tt;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(tt||(tt={}));var wo;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(wo||(wo={}));(function(e){e.codec=()=>bo(wo)})(tt||(tt={}));var se;(function(e){let t;e.codec=()=>(t==null&&(t=Ri((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),tt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=tt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>_i(r,e.codec()),e.decode=r=>Ii(r,e.codec())})(se||(se={}));var oe;(function(e){let t;e.codec=()=>(t==null&&(t=Ri((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),tt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=tt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>_i(r,e.codec()),e.decode=r=>Ii(r,e.codec())})(oe||(oe={}));var Hx=M(Tn(),1),Gx=M(yf(),1),is=M(J(),1),ss=M(Mt(),1);var Po=M(Mt(),1);var gf={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function mf(e,t,r){let n=gf[e];if(n==null){let w=Object.keys(gf).join(" / ");throw(0,Po.default)(new Error(`unknown cipher type '${e}'. Must be ${w}`),"ERR_INVALID_CIPHER_TYPE")}if(t==null)throw(0,Po.default)(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,a=vt("key expansion"),u=2*(s+i+o),f=await $a(t,r),c=await f.digest(a),h=[],l=0;for(;l<u;){let w=await f.digest(Lt([c,a])),A=w.length;l+A>u&&(A=u-l),h.push(w),l+=A,c=await f.digest(c)}let d=u/2,p=Lt(h),y=p.subarray(0,d),x=p.subarray(d,u),v=w=>({iv:w.subarray(0,s),cipherKey:w.subarray(s,s+i),macKey:w.subarray(s+i)});return{k1:v(y),k2:v(x)}}var zr=M(Mt(),1);var Gm=M(yt(),1),Wm=M(Oi(),1),xf=M(J(),1);function ue(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Lt([new Uint8Array(t-r.length),r])}return xt(r,"base64url")}function Qt(e){let t=Hi(e);return new xf.default.jsbn.BigInteger(xt(t,"base16"),16)}function Hi(e,t){let r=vt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Lt([new Uint8Array(t-r.length),r])}return r}var vf={"P-256":256,"P-384":384,"P-521":521},hy=Object.keys(vf),Do=hy.join(" / ");async function bf(e){if(e!=="P-256"&&e!=="P-384"&&e!=="P-521")throw(0,zr.default)(new Error(`Unknown curve: ${e}. Must be ${Do}`),"ERR_INVALID_CURVE");let t=await dt.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]),r=async(s,o)=>{let a;o!=null?a=await dt.get().subtle.importKey("jwk",py(e,o),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):a=t.privateKey;let u=await dt.get().subtle.importKey("jwk",Sf(e,s),{name:"ECDH",namedCurve:e},!1,[]),f=await dt.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:u},a,vf[e]);return new Uint8Array(f,0,f.byteLength)},n=await dt.get().subtle.exportKey("jwk",t.publicKey);return{key:ly(n),genSharedKey:r}}var wf={"P-256":32,"P-384":48,"P-521":66};function ly(e){if(e.crv==null||e.x==null||e.y==null)throw(0,zr.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");if(e.crv!=="P-256"&&e.crv!=="P-384"&&e.crv!=="P-521")throw(0,zr.default)(new Error(`Unknown curve: ${e.crv}. Must be ${Do}`),"ERR_INVALID_CURVE");let t=wf[e.crv];return Lt([Uint8Array.from([4]),Hi(e.x,t),Hi(e.y,t)],1+t*2)}function Sf(e,t){if(e!=="P-256"&&e!=="P-384"&&e!=="P-521")throw(0,zr.default)(new Error(`Unknown curve: ${e}. Must be ${Do}`),"ERR_INVALID_CURVE");let r=wf[e];if(!Pt(t.subarray(0,1),Uint8Array.from([4])))throw(0,zr.default)(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:xt(t.subarray(1,r+1),"base64url"),y:xt(t.subarray(1+r),"base64url"),ext:!0}}var py=(e,t)=>({...Sf(e,t.public),d:xt(t.private,"base64url")});var Ef=bf;function Gi(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=dt.get();r*=8;async function u(h,l){let d=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),y={name:t,iv:p};typeof l=="string"&&(l=vt(l));let x={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},v=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await a.subtle.deriveKey(x,v,{name:t,length:r},!0,["encrypt"]),A=await a.subtle.encrypt(y,w,h);return Lt([d,y.iv,new Uint8Array(A)])}async function f(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),y=h.subarray(s+n),x={name:t,iv:p};typeof l=="string"&&(l=vt(l));let v={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},w=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await a.subtle.deriveKey(v,w,{name:t,length:r},!0,["decrypt"]),P=await a.subtle.decrypt(x,A,y);return new Uint8Array(P)}return{encrypt:u,decrypt:f}}async function Af(e,t){let r=rr.decode(e);return await Gi().decrypt(r,t)}var Qo={};St(Qo,{RsaPrivateKey:()=>Xr,RsaPublicKey:()=>Fn,fromJwk:()=>Fy,generateKeyPair:()=>My,unmarshalRsaPrivateKey:()=>Uy,unmarshalRsaPublicKey:()=>Ky});var Wo=M(Mt(),1);var Nx=M(Rf(),1),Kn=M(J(),1);var yy=M(Or(),1);var H=BigInt(0),nt=BigInt(1),Ye=BigInt(2),Dn=BigInt(3),Nf=BigInt(8),lt=Object.freeze({a:H,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:nt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Lf=(e,t)=>(e+t/Ye)/t,Wi={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=lt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-nt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Lf(s*e,t),u=Lf(-n*e,t),f=R(e-a*r-u*i,t),c=R(-a*n-u*s,t),h=f>o,l=c>o;if(h&&(f=t-f),l&&(c=t-c),f>o||c>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:f,k2neg:l,k2:c}}},fe=32,Wr=32,gy=32,Pf=fe+1,Df=2*fe+1;function kf(e){let{a:t,b:r}=lt,n=R(e*e),i=R(n*e);return R(i+t*e+r)}var Qi=lt.a===H,Zi=class extends Error{constructor(t){super(t)}};function Uf(e){if(!(e instanceof Y))throw new TypeError("JacobianPoint expected")}var Y=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof Z))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(Z.ZERO)?Y.ZERO:new Y(t.x,t.y,nt)}static toAffineBatch(t){let r=wy(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return Y.toAffineBatch(t).map(Y.fromAffine)}equals(t){Uf(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t,u=R(i*i),f=R(a*a),c=R(r*f),h=R(s*u),l=R(R(n*a)*f),d=R(R(o*i)*u);return c===h&&l===d}negate(){return new Y(this.x,R(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=R(t*t),s=R(r*r),o=R(s*s),a=t+s,u=R(Ye*(R(a*a)-i-o)),f=R(Dn*i),c=R(f*f),h=R(c-Ye*u),l=R(f*(u-h)-Nf*o),d=R(Ye*r*n);return new Y(h,l,d)}add(t){Uf(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t;if(s===H||o===H)return this;if(r===H||n===H)return t;let u=R(i*i),f=R(a*a),c=R(r*f),h=R(s*u),l=R(R(n*a)*f),d=R(R(o*i)*u),p=R(h-c),y=R(d-l);if(p===H)return y===H?this.double():Y.ZERO;let x=R(p*p),v=R(p*x),w=R(c*x),A=R(y*y-v-Ye*w),P=R(y*(w-A)-l*v),C=R(i*a*p);return new Y(A,P,C)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=Y.ZERO;if(typeof t=="bigint"&&t===H)return r;let n=Mf(t);if(n===nt)return this;if(!Qi){let h=r,l=this;for(;n>H;)n&nt&&(h=h.add(l)),l=l.double(),n>>=nt;return h}let{k1neg:i,k1:s,k2neg:o,k2:a}=Wi.splitScalar(n),u=r,f=r,c=this;for(;s>H||a>H;)s&nt&&(u=u.add(c)),a&nt&&(f=f.add(c)),c=c.double(),s>>=nt,a>>=nt;return i&&(u=u.negate()),o&&(f=f.negate()),f=new Y(R(f.x*Wi.beta),f.y,f.z),u.add(f)}precomputeWindow(t){let r=Qi?128/t+1:256/t+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(t-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(Y.BASE)&&(r=Z.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Fo.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Y.normalizeZ(i),Fo.set(r,i)));let s=Y.ZERO,o=Y.BASE,a=1+(Qi?128/n:256/n),u=2**(n-1),f=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*u,p=Number(t&f);t>>=h,p>u&&(p-=c,t+=nt);let y=d,x=d+Math.abs(p)-1,v=l%2!==0,w=p<0;p===0?o=o.add($i(v,i[y])):s=s.add($i(w,i[x]))}return{p:s,f:o}}multiply(t,r){let n=Mf(t),i,s;if(Qi){let{k1neg:o,k1:a,k2neg:u,k2:f}=Wi.splitScalar(n),{p:c,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(f,r);c=$i(o,c),l=$i(u,l),l=new Y(R(l.x*Wi.beta),l.y,l.z),i=c.add(l),s=h.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return Y.normalizeZ([i,s])[0]}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(Y.ZERO);t==null&&(t=s?Nf:Yr(i));let o=t,a=R(o*o),u=R(a*o),f=R(r*a),c=R(n*u),h=R(i*o);if(s)return Z.ZERO;if(h!==nt)throw new Error("invZ was invalid");return new Z(f,c)}};Y.BASE=new Y(lt.Gx,lt.Gy,nt);Y.ZERO=new Y(H,nt,H);function $i(e,t){let r=t.negate();return e?r:t}var Fo=new WeakMap,Z=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Fo.delete(this)}hasEvenY(){return this.y%Ye===H}static fromCompressedHex(t){let r=t.length===32,n=Ze(r?t:t.subarray(1));if(!Ko(n))throw new Error("Point is not on curve");let i=kf(n),s=by(i),o=(s&nt)===nt;r?o&&(s=R(-s)):(t[0]&1)===1!==o&&(s=R(-s));let a=new Z(n,s);return a.assertValidity(),a}static fromUncompressedHex(t){let r=Ze(t.subarray(1,fe+1)),n=Ze(t.subarray(fe+1,fe*2+1)),i=new Z(r,n);return i.assertValidity(),i}static fromHex(t){let r=$r(t),n=r.length,i=r[0];if(n===fe)return this.fromCompressedHex(r);if(n===Pf&&(i===2||i===3))return this.fromCompressedHex(r);if(n===Df&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Pf} compressed bytes or ${Df} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return Z.BASE.multiply(Ji(t))}static fromSignature(t,r,n){let{r:i,s}=Of(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let o=Vo($r(t)),{n:a}=lt,u=n===2||n===3?i+a:i,f=Yr(u,a),c=R(-o*f,a),h=R(s*f,a),l=n&1?"03":"02",d=Z.fromHex(l+Hr(u)),p=Z.BASE.multiplyAndAddUnsafe(d,c,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(t=!1){return mr(this.toHex(t))}toHex(t=!1){let r=Hr(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${Hr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!Ko(r)||!Ko(n))throw new Error(t);let i=R(n*n),s=kf(r);if(R(i-s)!==H)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Z(this.x,R(-this.y))}double(){return Y.fromAffine(this).double().toAffine()}add(t){return Y.fromAffine(this).add(Y.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return Y.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=Y.fromAffine(this),s=r===H||r===nt||this!==Z.BASE?i.multiplyUnsafe(r):i.multiply(r),o=Y.fromAffine(t).multiplyUnsafe(n),a=s.add(o);return a.equals(Y.ZERO)?void 0:a.toAffine()}};Z.BASE=new Z(lt.Gx,lt.Gy);Z.ZERO=new Z(H,H);function Kf(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Ff(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${Qr(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ze(r),left:e.subarray(t+2)}}function my(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${Qr(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=Ff(e.subarray(2)),{data:n,left:i}=Ff(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Qr(i)}`);return{r:t,s:n}}var Se=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Qr(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Se(Xi(i.slice(0,64)),Xi(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=my(r?t:mr(t));return new Se(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Un(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Un(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=lt.n>>nt;return this.s>t}normalizeS(){return this.hasHighS()?new Se(this.r,R(-this.s,lt.n)):this}toDERRawBytes(){return mr(this.toDERHex())}toDERHex(){let t=Kf(Pn(this.s)),r=Kf(Pn(this.r)),n=t.length/2,i=r.length/2,s=Pn(n),o=Pn(i);return`30${Pn(i+n+4)}02${o}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return mr(this.toCompactHex())}toCompactHex(){return Hr(this.r)+Hr(this.s)}};function $e(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var xy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Qr(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=xy[e[r]];return t}var vy=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Hr(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(H<=e&&e<vy))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function Mo(e){let t=mr(Hr(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Pn(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Xi(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function mr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Ze(e){return Xi(Qr(e))}function $r(e){return e instanceof Uint8Array?Uint8Array.from(e):mr(e)}function Mf(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&Un(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(e,t=lt.P){let r=e%t;return r>=H?r:t+r}function jt(e,t){let{P:r}=lt,n=e;for(;t-- >H;)n*=n,n%=r;return n}function by(e){let{P:t}=lt,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),u=e*e*e%t,f=u*u*e%t,c=jt(f,Dn)*f%t,h=jt(c,Dn)*f%t,l=jt(h,Ye)*u%t,d=jt(l,n)*l%t,p=jt(d,i)*d%t,y=jt(p,o)*p%t,x=jt(y,a)*y%t,v=jt(x,o)*p%t,w=jt(v,Dn)*f%t,A=jt(w,s)*d%t,P=jt(A,r)*u%t,C=jt(P,Ye);if(C*C%t!==e)throw new Error("Cannot find square root");return C}function Yr(e,t=lt.P){if(e===H||t<=H)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=R(e,t),n=t,i=H,s=nt,o=nt,a=H;for(;r!==H;){let f=n/r,c=n%r,h=i-o*f,l=s-a*f;n=r,r=c,i=o,s=a,o=h,a=l}if(n!==nt)throw new Error("invert: does not exist");return R(i,t)}function wy(e,t=lt.P){let r=new Array(e.length),n=e.reduce((s,o,a)=>o===H?s:(r[a]=s,R(s*o,t)),nt),i=Yr(n,t);return e.reduceRight((s,o,a)=>o===H?s:(r[a]=R(s*r[a],t),R(s*o,t)),i),r}function Sy(e){let t=e.length*8-Wr*8,r=Ze(e);return t>0?r>>BigInt(t):r}function Vo(e,t=!1){let r=Sy(e);if(t)return r;let{n}=lt;return r>=n?r-n:r}var Gr,kn,Oo=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return ce.hmacSha256(this.k,...t)}hmacSync(...t){return kn(this.k,...t)}checkSync(){if(typeof kn!="function")throw new Zi("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return $e(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return $e(...r)}};function Un(e){return H<e&&e<lt.n}function Ko(e){return H<e&&e<lt.P}function Ey(e,t,r,n=!0){let{n:i}=lt,s=Vo(e,!0);if(!Un(s))return;let o=Yr(s,i),a=Z.BASE.multiply(s),u=R(a.x,i);if(u===H)return;let f=R(o*R(t+r*u,i),i);if(f===H)return;let c=new Se(u,f),h=(a.x===c.r?0:2)|Number(a.y&nt);return n&&c.hasHighS()&&(c=c.normalizeS(),h^=1),{sig:c,recovery:h}}function Ji(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*Wr)throw new Error("Expected 32 bytes of private key");t=Xi(e)}else if(e instanceof Uint8Array){if(e.length!==Wr)throw new Error("Expected 32 bytes of private key");t=Ze(e)}else throw new TypeError("Expected valid private key");if(!Un(t))throw new Error("Expected private key: 0 < key < n");return t}function By(e){return e instanceof Z?(e.assertValidity(),e):Z.fromHex(e)}function Of(e){if(e instanceof Se)return e.assertValidity(),e;try{return Se.fromDER(e)}catch{return Se.fromCompact(e)}}function qo(e,t=!1){return Z.fromPrivateKey(e).toRawBytes(t)}function Vf(e){let t=e.length>fe?e.slice(0,fe):e;return Ze(t)}function Ay(e){let t=Vf(e),r=R(t,lt.n);return qf(r<H?t:r)}function qf(e){return Mo(e)}function Cy(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=$r(e),i=Ji(t),s=[qf(i),Ay(n)];if(r!=null){r===!0&&(r=ce.randomBytes(fe));let u=$r(r);if(u.length!==fe)throw new Error(`sign: Expected ${fe} bytes of extra data`);s.push(u)}let o=$e(...s),a=Vf(n);return{seed:o,m:a,d:i}}function Iy(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),o=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function zf(e,t,r={}){let{seed:n,m:i,d:s}=Cy(e,t,r.extraEntropy),o=new Oo(gy,Wr);await o.reseed(n);let a;for(;!(a=Ey(await o.generate(),i,s,r.canonical));)await o.reseed();return Iy(a,r)}var _y={strict:!0};function Hf(e,t,r,n=_y){let i;try{i=Of(e),t=$r(t)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=Vo(t),u;try{u=By(r)}catch{return!1}let{n:f}=lt,c=Yr(o,f),h=R(a*c,f),l=R(s*c,f),d=Z.BASE.multiplyAndAddUnsafe(u,h,l);return d?R(d.x,f)===s:!1}Z.BASE._setWindowSize(8);var $t={node:yy,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Yi={},ce={bytesToHex:Qr,hexToBytes:mr,concatBytes:$e,mod:R,invert:Yr,isValidPrivateKey(e){try{return Ji(e),!0}catch{return!1}},_bigintTo32Bytes:Mo,_normalizePrivateKey:Ji,hashToPrivateKey:e=>{e=$r(e);let t=Wr+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Ze(e),lt.n-nt)+nt;return Mo(r)},randomBytes:(e=32)=>{if($t.web)return $t.web.getRandomValues(new Uint8Array(e));if($t.node){let{randomBytes:t}=$t.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ce.hashToPrivateKey(ce.randomBytes(Wr+8)),precompute(e=8,t=Z.BASE){let r=t===Z.BASE?t:new Z(t.x,t.y);return r._setWindowSize(e),r.multiply(Dn),r},sha256:async(...e)=>{if($t.web){let t=await $t.web.subtle.digest("SHA-256",$e(...e));return new Uint8Array(t)}else if($t.node){let{createHash:t}=$t.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if($t.web){let r=await $t.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=$e(...t),i=await $t.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if($t.node){let{createHmac:r}=$t.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=Yi[e];if(r===void 0){let n=await ce.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=$e(n,n),Yi[e]=r}return ce.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof Gr!="function")throw new Zi("sha256Sync is undefined, you need to set it");let r=Yi[e];if(r===void 0){let n=Gr(Uint8Array.from(e,i=>i.charCodeAt(0)));r=$e(n,n),Yi[e]=r}return Gr(r,...t)},_JacobianPoint:Y};Object.defineProperties(ce,{sha256Sync:{configurable:!1,get(){return Gr},set(e){Gr||(Gr=e)}},hmacSha256Sync:{configurable:!1,get(){return kn},set(e){kn||(kn=e)}}});var Gf=M(Mt(),1);function xr(e){if(isNaN(e)||e<=0)throw(0,Gf.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return ce.randomBytes(e)}var vr={};St(vr,{jwkToPkcs1:()=>Ny,jwkToPkix:()=>Py,pkcs1ToJwk:()=>Ry,pkixToJwk:()=>Ly});var px=M(Tn(),1),dx=M(zi(),1),Pe=M(J(),1);var zo=M(Mt(),1);function Ry(e){let t=Pe.default.asn1.fromDer(xt(e,"ascii")),r=Pe.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:ue(r.n),e:ue(r.e),d:ue(r.d),p:ue(r.p),q:ue(r.q),dp:ue(r.dP),dq:ue(r.dQ),qi:ue(r.qInv),alg:"RS256"}}function Ny(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw(0,zo.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Pe.default.pki.privateKeyToAsn1({n:Qt(e.n),e:Qt(e.e),d:Qt(e.d),p:Qt(e.p),q:Qt(e.q),dP:Qt(e.dp),dQ:Qt(e.dq),qInv:Qt(e.qi)});return vt(Pe.default.asn1.toDer(t).getBytes(),"ascii")}function Ly(e){let t=Pe.default.asn1.fromDer(xt(e,"ascii")),r=Pe.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:ue(r.n),e:ue(r.e)}}function Py(e){if(e.n==null||e.e==null)throw(0,zo.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Pe.default.pki.publicKeyToAsn1({n:Qt(e.n),e:Qt(e.e)});return vt(Pe.default.asn1.toDer(t).getBytes(),"ascii")}var xx=M(zi(),1),Ho=M(J(),1);function Wf(e,t){return t.map(r=>Qt(e[r]))}function Qf(e){return Ho.default.pki.setRsaPrivateKey(...Wf(e,["n","e","d","p","q","dp","dq","qi"]))}function $f(e){return Ho.default.pki.setRsaPublicKey(...Wf(e,["n","e"]))}var Yf=M(Mt(),1);async function Zf(e){let t=await dt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await jf(t);return{privateKey:r[0],publicKey:r[1]}}async function Go(e){let r=[await dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Dy(e)],n=await jf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Xf(e,t){let r=await dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await dt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Jf(e,t,r){let n=await dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await dt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function jf(e){if(e.privateKey==null||e.publicKey==null)throw(0,Yf.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([dt.get().subtle.exportKey("jwk",e.privateKey),dt.get().subtle.exportKey("jwk",e.publicKey)])}async function Dy(e){return await dt.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function tc(e,t,r,n){let i=t?$f(e):Qf(e),s=xt(Uint8Array.from(r),"ascii"),o=n(s,i);return vt(o,"ascii")}function ec(e,t){return tc(e,!0,t,(r,n)=>n.encrypt(r))}function rc(e,t){return tc(e,!1,t,(r,n)=>n.decrypt(r))}async function Zr(e,t){let n=await Gi().encrypt(e,t);return rr.encode(n)}var Fn=class{constructor(t){this._key=t}async verify(t,r){return await Jf(this._key,r,t)}marshal(){return vr.jwkToPkix(this._key)}get bytes(){return se.encode({Type:tt.RSA,Data:this.marshal()}).subarray()}encrypt(t){return ec(this._key,t)}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}},Xr=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return xr(16)}async sign(t){return await Xf(this._key,t)}get public(){if(this._publicKey==null)throw(0,Wo.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Fn(this._publicKey)}decrypt(t){return rc(this._key,t)}marshal(){return vr.jwkToPkcs1(this._key)}get bytes(){return oe.encode({Type:tt.RSA,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}async id(){let t=await this.public.hash();return xt(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Kn.default.util.ByteBuffer(this.marshal()),i=Kn.default.asn1.fromDer(n),s=Kn.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Kn.default.pki.encryptRsaPrivateKey(s,t,o)}else{if(r==="libp2p-key")return await Zr(this.bytes,t);throw(0,Wo.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Uy(e){let t=vr.pkcs1ToJwk(e),r=await Go(t);return new Xr(r.privateKey,r.publicKey)}function Ky(e){let t=vr.pkixToJwk(e);return new Fn(t)}async function Fy(e){let t=await Go(e);return new Xr(t.privateKey,t.publicKey)}async function My(e){let t=await Zf(e);return new Xr(t.privateKey,t.publicKey)}var ia={};St(ia,{Ed25519PrivateKey:()=>wr,Ed25519PublicKey:()=>zn,generateKeyPair:()=>sg,generateKeyPairFromSeed:()=>na,unmarshalEd25519PrivateKey:()=>ng,unmarshalEd25519PublicKey:()=>ig});var ra=M(Mt(),1);var Oy=M(Or(),1);var Tt=BigInt(0),W=BigInt(1),Jr=BigInt(2),nc=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),ot=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:nc,n:nc,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var ac=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Mn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Px=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Vy=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),qy=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),zy=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Hy=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),G=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof ct))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(ct.ZERO)?G.ZERO:new G(t.x,t.y,W,E(t.x*t.y))}static toAffineBatch(t){let r=Qy(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){ic(t);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=t,u=E(r*a),f=E(s*i),c=E(n*a),h=E(o*i);return u===f&&c===h}negate(){return new G(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=ot,s=E(t*t),o=E(r*r),a=E(Jr*E(n*n)),u=E(i*s),f=t+r,c=E(E(f*f)-s-o),h=u+o,l=h-a,d=u-o,p=E(c*l),y=E(h*d),x=E(c*d),v=E(l*h);return new G(p,y,v,x)}add(t){ic(t);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:u,t:f}=t,c=E((n-r)*(a+o)),h=E((n+r)*(a-o)),l=E(h-c);if(l===Tt)return this.double();let d=E(i*Jr*f),p=E(s*Jr*u),y=p+d,x=h+c,v=p-d,w=E(y*l),A=E(x*v),P=E(y*v),C=E(l*x);return new G(w,A,C,P)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(t-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(G.BASE)&&(r=ct.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Jo.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=G.normalizeZ(i),Jo.set(r,i)));let s=G.ZERO,o=G.ZERO,a=1+256/n,u=2**(n-1),f=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*u,p=Number(t&f);if(t>>=h,p>u&&(p-=c,t+=W),p===0){let y=i[d];l%2&&(y=y.negate()),o=o.add(y)}else{let y=i[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return G.normalizeZ([s,o])[0]}multiply(t,r){return this.wNAF(ts(t,ot.l),r)}multiplyUnsafe(t){let r=ts(t,ot.l,!1),n=G.BASE,i=G.ZERO;if(r===Tt)return i;if(this.equals(i)||r===W)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>Tt;)r&W&&(s=s.add(o)),o=o.double(),r>>=W;return s}isSmallOrder(){return this.multiplyUnsafe(ot.h).equals(G.ZERO)}isTorsionFree(){return this.multiplyUnsafe(ot.l).equals(G.ZERO)}toAffine(t=es(this.z)){let{x:r,y:n,z:i}=this,s=E(r*t),o=E(n*t);if(E(i*t)!==W)throw new Error("invZ was invalid");return new ct(s,o)}fromRistrettoBytes(){Yo()}toRistrettoBytes(){Yo()}fromRistrettoHash(){Yo()}};G.BASE=new G(ot.Gx,ot.Gy,W,E(ot.Gx*ot.Gy));G.ZERO=new G(Tt,W,W,Tt);function ic(e){if(!(e instanceof G))throw new TypeError("ExtendedPoint expected")}function $o(e){if(!(e instanceof Vt))throw new TypeError("RistrettoPoint expected")}function Yo(){throw new Error("Legacy method: switch to RistrettoPoint")}var Vt=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=ot,n=E(Mn*t*t),i=E((n+W)*zy),s=BigInt(-1),o=E((s-r*n)*E(n+r)),{isValid:a,value:u}=ta(i,o),f=E(u*t);Je(f)||(f=E(-f)),a||(u=f),a||(s=n);let c=E(s*(n-W)*Hy-o),h=u*u,l=E((u+u)*o),d=E(c*Vy),p=E(W-h),y=E(W+h);return new G(E(l*y),E(p*d),E(d*y),E(l*p))}static hashToCurve(t){t=je(t,64);let r=Zo(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Zo(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new Vt(n.add(s))}static fromHex(t){t=je(t,32);let{a:r,d:n}=ot,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Zo(t);if(!Yy(On(s),t)||Je(s))throw new Error(i);let o=E(s*s),a=E(W+r*o),u=E(W-r*o),f=E(a*a),c=E(u*u),h=E(r*n*f-c),{isValid:l,value:d}=oc(E(h*c)),p=E(d*u),y=E(d*p*h),x=E((s+s)*p);Je(x)&&(x=E(-x));let v=E(a*y),w=E(x*v);if(!l||Je(w)||v===Tt)throw new Error(i);return new Vt(new G(x,v,W,w))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=E(E(n+r)*E(n-r)),o=E(t*r),a=E(o*o),{value:u}=oc(E(s*a)),f=E(u*s),c=E(u*o),h=E(f*c*i),l;if(Je(i*h)){let p=E(r*Mn),y=E(t*Mn);t=p,r=y,l=E(f*qy)}else l=c;Je(t*h)&&(r=E(-r));let d=E((n-r)*l);return Je(d)&&(d=E(-d)),On(d)}toHex(){return Vn(this.toRawBytes())}toString(){return this.toHex()}equals(t){$o(t);let r=this.ep,n=t.ep,i=E(r.x*n.y)===E(r.y*n.x),s=E(r.y*n.y)===E(r.x*n.x);return i||s}add(t){return $o(t),new Vt(this.ep.add(t.ep))}subtract(t){return $o(t),new Vt(this.ep.subtract(t.ep))}multiply(t){return new Vt(this.ep.multiply(t))}multiplyUnsafe(t){return new Vt(this.ep.multiplyUnsafe(t))}};Vt.BASE=new Vt(G.BASE);Vt.ZERO=new Vt(G.ZERO);var Jo=new WeakMap,ct=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Jo.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=ot;t=je(t,32);let s=t.slice();s[31]=t[31]&-129;let o=qn(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=ac)throw new Error("Expected 0 < hex < 2**256");let a=E(o*o),u=E(a-W),f=E(n*a+W),{isValid:c,value:h}=ta(u,f);if(!c)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&W)===W;return(t[31]&128)!==0!==l&&(h=E(-h)),new ct(h,o)}static async fromPrivateKey(t){return(await rs(t)).point}toRawBytes(){let t=On(this.y);return t[31]|=this.x&W?128:0,t}toHex(){return Vn(this.toRawBytes())}toX25519(){let{y:t}=this,r=E((W+t)*es(W-t));return On(r)}isTorsionFree(){return G.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ct(E(-this.x),this.y)}add(t){return G.fromAffine(this).add(G.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return G.fromAffine(this).multiply(t,this).toAffine()}};ct.BASE=new ct(ot.Gx,ot.Gy);ct.ZERO=new ct(Tt,W);var br=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=je(t,64),n=ct.fromHex(r.slice(0,32),!1),i=qn(r.slice(32,64));return new br(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof ct))throw new Error("Expected Point instance");return ts(r,ot.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(On(this.s),32),t}toHex(){return Vn(this.toRawBytes())}};function sc(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var Gy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Vn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=Gy[e[r]];return t}function jo(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function uc(e){let r=e.toString(16).padStart(64,"0");return jo(r)}function On(e){return uc(e).reverse()}function Je(e){return(E(e)&W)===W}function qn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Vn(Uint8Array.from(e).reverse()))}var Wy=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Zo(e){return E(qn(e)&Wy)}function E(e,t=ot.P){let r=e%t;return r>=Tt?r:t+r}function es(e,t=ot.P){if(e===Tt||t<=Tt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=E(e,t),n=t,i=Tt,s=W,o=W,a=Tt;for(;r!==Tt;){let f=n/r,c=n%r,h=i-o*f,l=s-a*f;n=r,r=c,i=o,s=a,o=h,a=l}if(n!==W)throw new Error("invert: does not exist");return E(i,t)}function Qy(e,t=ot.P){let r=new Array(e.length),n=e.reduce((s,o,a)=>o===Tt?s:(r[a]=s,E(s*o,t)),W),i=es(n,t);return e.reduceRight((s,o,a)=>o===Tt?s:(r[a]=E(s*r[a],t),E(s*o,t)),i),r}function Ee(e,t){let{P:r}=ot,n=e;for(;t-- >Tt;)n*=n,n%=r;return n}function $y(e){let{P:t}=ot,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),u=e*e%t*e%t,f=Ee(u,Jr)*u%t,c=Ee(f,W)*e%t,h=Ee(c,r)*c%t,l=Ee(h,n)*h%t,d=Ee(l,i)*l%t,p=Ee(d,s)*d%t,y=Ee(p,o)*p%t,x=Ee(y,o)*p%t,v=Ee(x,n)*h%t;return{pow_p_5_8:Ee(v,Jr)*e%t,b2:u}}function ta(e,t){let r=E(t*t*t),n=E(r*r*t),i=$y(e*n).pow_p_5_8,s=E(e*r*i),o=E(t*s*s),a=s,u=E(s*Mn),f=o===e,c=o===E(-e),h=o===E(-e*Mn);return f&&(s=a),(c||h)&&(s=u),Je(s)&&(s=E(-s)),{isValid:f||c,value:s}}function oc(e){return ta(W,e)}function ji(e){return E(qn(e),ot.l)}function Yy(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function je(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):jo(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function ts(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(Tt<e)return e}else if(Tt<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Zy(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Xy(e){if(e=typeof e=="bigint"||typeof e=="number"?uc(ts(e,ac)):je(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function Jy(e){let t=Zy(e.slice(0,32)),r=e.slice(32,64),n=ji(t),i=ct.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var Xo;async function rs(e){return Jy(await tr.sha512(Xy(e)))}async function ea(e){return(await rs(e)).pointBytes}async function fc(e,t){e=je(e);let{prefix:r,scalar:n,pointBytes:i}=await rs(t),s=ji(await tr.sha512(r,e)),o=ct.BASE.multiply(s),a=ji(await tr.sha512(o.toRawBytes(),i,e)),u=E(s+a*n,ot.l);return new br(o,u).toRawBytes()}function jy(e,t,r){t=je(t),r instanceof ct||(r=ct.fromHex(r,!1));let{r:n,s:i}=e instanceof br?e.assertValidity():br.fromHex(e),s=G.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function tg(e,t,r,n){let i=ji(n),s=G.fromAffine(e).multiplyUnsafe(i);return G.fromAffine(t).add(s).subtract(r).multiplyUnsafe(ot.h).equals(G.ZERO)}async function cc(e,t,r){let{r:n,SB:i,msg:s,pub:o}=jy(e,t,r),a=await tr.sha512(n.toRawBytes(),o.toRawBytes(),s);return tg(o,n,i,a)}ct.BASE._setWindowSize(8);var Xe={node:Oy,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},tr={bytesToHex:Vn,hexToBytes:jo,concatBytes:sc,getExtendedPublicKey:rs,mod:E,invert:es,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=je(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(qn(e),ot.l-W)+W},randomBytes:(e=32)=>{if(Xe.web)return Xe.web.getRandomValues(new Uint8Array(e));if(Xe.node){let{randomBytes:t}=Xe.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>tr.randomBytes(32),sha512:async(...e)=>{let t=sc(...e);if(Xe.web){let r=await Xe.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(Xe.node)return Uint8Array.from(Xe.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=ct.BASE){let r=t.equals(ct.BASE)?t:new ct(t.x,t.y);return r._setWindowSize(e),r.multiply(Jr),r},sha512Sync:void 0};Object.defineProperties(tr,{sha512Sync:{configurable:!1,get(){return Xo},set(e){Xo||(Xo=e)}}});var jr=32,De=64,ns=32;async function hc(){let e=tr.randomPrivateKey(),t=await ea(e);return{privateKey:yc(e,t),publicKey:t}}async function lc(e){if(e.length!==ns)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await ea(t);return{privateKey:yc(t,r),publicKey:r}}async function pc(e,t){let r=e.subarray(0,ns);return await fc(t,r)}async function dc(e,t,r){return await cc(t,r,e)}function yc(e,t){let r=new Uint8Array(De);for(let n=0;n<ns;n++)r[n]=e[n],r[ns+n]=t[n];return r}var zn=class{constructor(t){this._key=tn(t,jr)}async verify(t,r){return await dc(this._key,r,t)}marshal(){return this._key}get bytes(){return se.encode({Type:tt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}},wr=class{constructor(t,r){this._key=tn(t,De),this._publicKey=tn(r,jr)}async sign(t){return await pc(this._key,t)}get public(){return new zn(this._publicKey)}marshal(){return this._key}get bytes(){return oe.encode({Type:tt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}async id(){let t=await ze.digest(this.public.bytes);return Rt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await Zr(this.bytes,t);throw(0,ra.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function ng(e){if(e.length>De){e=tn(e,De+jr);let n=e.subarray(0,De),i=e.subarray(De,e.length);return new wr(n,i)}e=tn(e,De);let t=e.subarray(0,De),r=e.subarray(jr);return new wr(t,r)}function ig(e){return e=tn(e,jr),new zn(e)}async function sg(){let{privateKey:e,publicKey:t}=await hc();return new wr(e,t)}async function na(e){let{privateKey:t,publicKey:r}=await lc(e);return new wr(t,r)}function tn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw(0,ra.default)(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}var oa={};St(oa,{Secp256k1PrivateKey:()=>Gn,Secp256k1PublicKey:()=>Hn,generateKeyPair:()=>fg,unmarshalSecp256k1PrivateKey:()=>ag,unmarshalSecp256k1PublicKey:()=>ug});var Sc=M(Mt(),1);var en=M(Mt(),1);function gc(){return ce.randomPrivateKey()}async function mc(e,t){let{digest:r}=await Et.digest(t);try{return await zf(r,e)}catch(n){throw(0,en.default)(n,"ERR_INVALID_INPUT")}}async function xc(e,t,r){try{let{digest:n}=await Et.digest(r);return Hf(t,n,e)}catch(n){throw(0,en.default)(n,"ERR_INVALID_INPUT")}}function vc(e){return Z.fromHex(e).toRawBytes(!0)}function bc(e){try{qo(e,!0)}catch(t){throw(0,en.default)(t,"ERR_INVALID_PRIVATE_KEY")}}function sa(e){try{Z.fromHex(e)}catch(t){throw(0,en.default)(t,"ERR_INVALID_PUBLIC_KEY")}}function wc(e){try{return qo(e,!0)}catch(t){throw(0,en.default)(t,"ERR_INVALID_PRIVATE_KEY")}}var Hn=class{constructor(t){sa(t),this._key=t}async verify(t,r){return await xc(this._key,r,t)}marshal(){return vc(this._key)}get bytes(){return se.encode({Type:tt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}},Gn=class{constructor(t,r){this._key=t,this._publicKey=r??wc(t),bc(this._key),sa(this._publicKey)}async sign(t){return await mc(this._key,t)}get public(){return new Hn(this._publicKey)}marshal(){return this._key}get bytes(){return oe.encode({Type:tt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Et.digest(this.bytes);return t}async id(){let t=await this.public.hash();return xt(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await Zr(this.bytes,t);throw(0,Sc.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function ag(e){return new Gn(e)}function ug(e){return new Hn(e)}async function fg(){let e=await gc();return new Gn(e)}var Be={rsa:Qo,ed25519:ia,secp256k1:oa};function aa(e){let t=Object.keys(Be).join(" / ");return(0,ss.default)(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function ua(e){if(e=e.toLowerCase(),e==="rsa"||e==="ed25519"||e==="secp256k1")return Be[e];throw aa(e)}async function cg(e,t){return await ua(e).generateKeyPair(t??2048)}async function hg(e,t,r){if(e.toLowerCase()!=="ed25519")throw(0,ss.default)(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await na(t)}function lg(e){let t=se.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case tt.RSA:return Be.rsa.unmarshalRsaPublicKey(r);case tt.Ed25519:return Be.ed25519.unmarshalEd25519PublicKey(r);case tt.Secp256k1:return Be.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw aa(t.Type??"RSA")}}function pg(e,t){return t=(t??"rsa").toLowerCase(),ua(t),e.bytes}async function Ec(e){let t=oe.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case tt.RSA:return await Be.rsa.unmarshalRsaPrivateKey(r);case tt.Ed25519:return Be.ed25519.unmarshalEd25519PrivateKey(r);case tt.Secp256k1:return Be.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw aa(t.Type??"RSA")}}function dg(e,t){return t=(t??"rsa").toLowerCase(),ua(t),e.bytes}async function yg(e,t){try{let i=await Af(e,t);return await Ec(i)}catch{}let r=is.default.pki.decryptRsaPrivateKey(e,t);if(r===null)throw(0,ss.default)(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=is.default.asn1.toDer(is.default.pki.privateKeyToAsn1(r));return n=vt(n.getBytes(),"ascii"),await Be.rsa.unmarshalRsaPrivateKey(n)}var gg=M(Eo(),1),mg=M(yt(),1),xg=M(Mt(),1);var Bc=Symbol.for("@libp2p/peer-id");var vg=Symbol.for("nodejs.util.inspect.custom"),Ac=Object.values(Ur).map(e=>e.decoder).reduce((e,t)=>e.or(t),Ur.identity.decoder),Cc=114,fa=36,ca=37,Qn=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Bc](){return!0}toString(){return this.string==null&&(this.string=Rt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return ft.createV1(Cc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Pt(this.multihash.bytes,t);if(typeof t=="string")return bt(t).equals(this);if(t?.multihash?.bytes!=null)return Pt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[vg](){return`PeerId(${this.toString()})`}},rn=class extends Qn{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},nn=class extends Qn{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},sn=class extends Qn{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function bt(e,t){if(t=t??Ac,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=En(Rt.decode(`z${e}`));return e.startsWith("12D")?new nn({multihash:r}):e.startsWith("16U")?new sn({multihash:r}):new rn({multihash:r})}return os(Ac.decode(e))}function os(e){try{let t=En(e);if(t.code===ze.code){if(t.digest.length===fa)return new nn({multihash:t});if(t.digest.length===ca)return new sn({multihash:t})}if(t.code===Et.code)return new rn({multihash:t})}catch{return bg(ft.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function bg(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==Cc)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Et.code)return new rn({multihash:e.multihash});if(t.code===ze.code){if(t.digest.length===fa)return new nn({multihash:e.multihash});if(t.digest.length===ca)return new sn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function as(e,t){return e.length===fa?new nn({multihash:pe(ze.code,e),privateKey:t}):e.length===ca?new sn({multihash:pe(ze.code,e),privateKey:t}):new rn({multihash:await Et.digest(e),publicKey:e,privateKey:t})}function Ic(){return BigInt(`0x${xt(xr(8),"base16")}`)}var _c=(e,t)=>{let r=vt(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n},Tc=e=>Et.encode(e);var Rc=function(e){return Array.isArray(e)?e:[e]},wg=async e=>{if(e.sequenceNumber==null||e.from==null||e.signature==null)return!1;let t=os(e.from);return t.publicKey!=null?!0:e.key!=null?(await as(e.key)).equals(t):!1},Nc=async e=>{if(e.from==null)throw new at("RPC message was missing from",Bt.ERR_MISSING_FROM);return await wg(e)?{type:"signed",from:os(e.from),topic:e.topic??"",sequenceNumber:Eg(e.sequenceNumber??new Uint8Array(0)),data:e.data??new Uint8Array(0),signature:e.signature??new Uint8Array(0),key:e.key}:{type:"unsigned",topic:e.topic??"",data:e.data??new Uint8Array(0)}},$n=e=>e.type==="signed"?{from:e.from.multihash.bytes,data:e.data,sequenceNumber:Sg(e.sequenceNumber),topic:e.topic,signature:e.signature,key:e.key}:{data:e.data,topic:e.topic},Sg=e=>{let t=e.toString(16);return t.length%2!==0&&(t=`0${t}`),vt(t,"base16")},Eg=e=>BigInt(`0x${xt(e,"base16")}`);var Lc=vt("libp2p-pubsub:");async function Pc(e,t,r){if(e.privateKey==null)throw new Error("Cannot sign message, no private key present");if(e.publicKey==null)throw new Error("Cannot sign message, no public key present");let n={type:"signed",topic:t.topic,data:t.data,sequenceNumber:t.sequenceNumber,from:e},i=Lt([Lc,r($n(n)).subarray()]),s=await Wn.unmarshalPrivateKey(e.privateKey);return n.signature=await s.sign(i),n.key=e.publicKey,n}async function Dc(e,t){if(e.type!=="signed")throw new Error('Message type must be "signed" to be verified');if(e.signature==null)throw new Error("Message must contain a signature to be verified");if(e.from==null)throw new Error("Message must contain a from property to be verified");let r=Lt([Lc,t({...$n(e),signature:void 0,key:void 0}).subarray()]),n=await Bg(e);return await Wn.unmarshalPublicKey(n).verify(r,e.signature)}async function Bg(e){if(e.type!=="signed")throw new Error('Message type must be "signed" to have a public key');if(e.from==null)throw new Error("Could not get the public key from the originator id");if(e.key!=null){let t=await as(e.key);if(t.publicKey!=null)return t.publicKey}if(e.from.publicKey!=null)return e.from.publicKey;throw new Error("Could not get the public key from the originator id")}var Yn;(function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"})(Yn||(Yn={}));function ke(e,t){let r={[Symbol.iterator]:()=>r,next:()=>{let n=e.next(),i=n.value;return n.done===!0||i==null?{done:!0,value:void 0}:{done:!1,value:t(i)}}};return r}var Zn=class{constructor(t){if(this.map=new Map,t!=null)for(let[r,n]of t.entries())this.map.set(r.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(t){this.map.delete(t.toString())}entries(){return ke(this.map.entries(),t=>[bt(t[0]),t[1]])}forEach(t){this.map.forEach((r,n)=>{t(r,bt(n),this)})}get(t){return this.map.get(t.toString())}has(t){return this.map.has(t.toString())}set(t,r){this.map.set(t.toString(),r)}keys(){return ke(this.map.keys(),t=>bt(t))}values(){return this.map.values()}get size(){return this.map.size}};var Ue=class{constructor(t){if(this.set=new Set,t!=null)for(let r of t)this.set.add(r.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(t){this.set.add(t.toString())}clear(){this.set.clear()}delete(t){this.set.delete(t.toString())}entries(){return ke(this.set.entries(),t=>{let r=bt(t[0]);return[r,r]})}forEach(t){this.set.forEach(r=>{let n=bt(r);t(n,n,this)})}has(t){return this.set.has(t.toString())}values(){return ke(this.set.values(),t=>bt(t))}intersection(t){let r=new Ue;for(let n of t)this.has(n)&&r.add(n);return r}difference(t){let r=new Ue;for(let n of this)t.has(n)||r.add(n);return r}union(t){let r=new Ue;for(let n of t)r.add(n);for(let n of this)r.add(n);return r}};var on=class{constructor(t){if(this.list=[],t!=null)for(let r of t)this.list.push(r.toString())}[Symbol.iterator](){return ke(this.list.entries(),t=>bt(t[1]))}concat(t){let r=new on(this);for(let n of t)r.push(n);return r}entries(){return ke(this.list.entries(),t=>[t[0],bt(t[1])])}every(t){return this.list.every((r,n)=>t(bt(r),n,this))}filter(t){let r=new on;return this.list.forEach((n,i)=>{let s=bt(n);t(s,i,this)&&r.push(s)}),r}find(t){let r=this.list.find((n,i)=>t(bt(n),i,this));if(r!=null)return bt(r)}findIndex(t){return this.list.findIndex((r,n)=>t(bt(r),n,this))}forEach(t){this.list.forEach((r,n)=>{t(bt(r),n,this)})}includes(t){return this.list.includes(t.toString())}indexOf(t){return this.list.indexOf(t.toString())}pop(){let t=this.list.pop();if(t!=null)return bt(t)}push(...t){for(let r of t)this.list.push(r.toString())}shift(){let t=this.list.shift();if(t!=null)return bt(t)}unshift(...t){let r=this.list.length;for(let n=t.length-1;n>-1;n--)r=this.list.unshift(t[n].toString());return r}get length(){return this.list.length}};var it=ei("libp2p:pubsub"),ha=class extends Ir{constructor(t,r){super();let{multicodecs:n=[],globalSignaturePolicy:i="StrictSign",canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:a=10,maxInboundStreams:u=1,maxOutboundStreams:f=1}=r;this.components=t,this.multicodecs=Rc(n),this.enabled=r.enabled!==!1,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Zn,this.globalSignaturePolicy=i==="StrictNoSign"?"StrictNoSign":"StrictSign",this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new gn({concurrency:a}),this.maxInboundStreams=u,this.maxOutboundStreams=f,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}async start(){if(this.started||!this.enabled)return;it("starting");let t=this.components.registrar;await Promise.all(this.multicodecs.map(async n=>await t.handle(n,this._onIncomingStream,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r=Fa({onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected});this._registrarTopologyIds=await Promise.all(this.multicodecs.map(async n=>await t.register(n,r))),it("started"),this.started=!0}async stop(){if(!this.started||!this.enabled)return;let t=this.components.registrar;this._registrarTopologyIds!=null&&this._registrarTopologyIds?.map(r=>t.unregister(r)),await Promise.all(this.multicodecs.map(async r=>await t.unhandle(r))),it("stopping");for(let r of this.peers.values())r.close();this.peers.clear(),this.subscriptions=new Set,this.started=!1,it("stopped")}isStarted(){return this.started}_onIncomingStream(t){let{stream:r,connection:n}=t,i=n.remotePeer;if(r.stat.protocol==null){r.abort(new Error("Stream was not multiplexed"));return}let s=this.addPeer(i,r.stat.protocol),o=s.attachInboundStream(r);this.processMessages(i,o,s).catch(a=>it(a))}_onPeerConnected(t,r){it("connected %p",t),Promise.resolve().then(async()=>{try{let n=await r.newStream(this.multicodecs);if(n.stat.protocol==null){n.abort(new Error("Stream was not multiplexed"));return}await this.addPeer(t,n.stat.protocol).attachOutboundStream(n)}catch(n){it.error(n)}this.send(t,{subscriptions:Array.from(this.subscriptions).map(n=>n.toString()),subscribe:!0})}).catch(n=>{it.error(n)})}_onPeerDisconnected(t,r){let n=t.toString();it("connection ended",n),this._removePeer(t)}addPeer(t,r){let n=this.peers.get(t);if(n!=null)return n;it("new peer %p",t);let i=new yi({id:t,protocol:r});return this.peers.set(t,i),i.addEventListener("close",()=>this._removePeer(t),{once:!0}),i}_removePeer(t){let r=this.peers.get(t);if(r!=null){r.close(),it("delete peer %p",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return r}}async processMessages(t,r,n){try{await an(r,async i=>{for await(let s of i){let o=this.decodeRpc(s),a=[];for(let u of o.messages??[]){if(u.from==null||u.data==null||u.topic==null){it("message from %p was missing from, data or topic fields, dropping",t);continue}a.push({from:u.from,data:u.data,topic:u.topic,sequenceNumber:u.sequenceNumber??void 0,signature:u.signature??void 0,key:u.key??void 0})}this.processRpc(t,n,{subscriptions:(o.subscriptions??[]).map(u=>({subscribe:Boolean(u.subscribe),topic:u.topic??""})),messages:a}).catch(u=>it(u))}})}catch(i){this._onPeerDisconnected(n.id,i)}}async processRpc(t,r,n){if(!this.acceptFrom(t))return it("received message from unacceptable peer %p",t),!1;it("rpc from %p",t);let{subscriptions:i,messages:s}=n;return i!=null&&i.length>0&&(it("subscription update from %p",t),i.forEach(o=>{this.processRpcSubOpt(t,o)}),super.dispatchEvent(new le("subscription-change",{detail:{peerId:r.id,subscriptions:i.map(({topic:o,subscribe:a})=>({topic:`${o??""}`,subscribe:Boolean(a)}))}}))),s!=null&&s.length>0&&(it("messages from %p",t),this.queue.addAll(s.map(o=>async()=>{if(o.topic==null||!this.subscriptions.has(o.topic)&&!this.canRelayMessage)return it("received message we didn't subscribe to. Dropping."),!1;try{let a=await Nc(o);await this.processMessage(t,a)}catch(a){it.error(a)}})).catch(o=>it(o))),!0}processRpcSubOpt(t,r){let n=r.topic;if(n==null)return;let i=this.topics.get(n);i==null&&(i=new Ue,this.topics.set(n,i)),r.subscribe===!0?i.add(t):i.delete(t)}async processMessage(t,r){if(!(this.components.peerId.equals(t)&&!this.emitSelf)){try{await this.validate(t,r)}catch(n){it("Message is invalid, dropping it. %O",n);return}this.subscriptions.has(r.topic)&&(!this.components.peerId.equals(t)||this.emitSelf)&&super.dispatchEvent(new le("message",{detail:r})),await this.publishMessage(t,r)}}getMsgId(t){switch(this.globalSignaturePolicy){case"StrictSign":if(t.type!=="signed")throw new at('Message type should be "signed" when signature policy is StrictSign but it was not',Bt.ERR_MISSING_SIGNATURE);if(t.sequenceNumber==null)throw new at("Need seqno when signature policy is StrictSign but it was missing",Bt.ERR_MISSING_SEQNO);if(t.key==null)throw new at("Need key when signature policy is StrictSign but it was missing",Bt.ERR_MISSING_KEY);return _c(t.key,t.sequenceNumber);case"StrictNoSign":return Tc(t.data);default:throw new at("Cannot get message id: unhandled signature policy",Bt.ERR_UNHANDLED_SIGNATURE_POLICY)}}acceptFrom(t){return!0}send(t,r){let{messages:n,subscriptions:i,subscribe:s}=r;return this.sendRpc(t,{subscriptions:(i??[]).map(o=>({topic:o,subscribe:Boolean(s)})),messages:(n??[]).map($n)})}sendRpc(t,r){let n=this.peers.get(t);if(n==null||!n.isWritable){it.error("Cannot send RPC to %p as there is no open stream to it available",t);return}n.write(this.encodeRpc(r))}async validate(t,r){switch(this.globalSignaturePolicy){case"StrictNoSign":if(r.type!=="unsigned")throw new at('Message type should be "unsigned" when signature policy is StrictNoSign but it was not',Bt.ERR_MISSING_SIGNATURE);if(r.signature!=null)throw new at("StrictNoSigning: signature should not be present",Bt.ERR_UNEXPECTED_SIGNATURE);if(r.key!=null)throw new at("StrictNoSigning: key should not be present",Bt.ERR_UNEXPECTED_KEY);if(r.sequenceNumber!=null)throw new at("StrictNoSigning: seqno should not be present",Bt.ERR_UNEXPECTED_SEQNO);break;case"StrictSign":if(r.type!=="signed")throw new at('Message type should be "signed" when signature policy is StrictSign but it was not',Bt.ERR_MISSING_SIGNATURE);if(r.signature==null)throw new at("StrictSigning: Signing required and no signature was present",Bt.ERR_MISSING_SIGNATURE);if(r.sequenceNumber==null)throw new at("StrictSigning: Signing required and no sequenceNumber was present",Bt.ERR_MISSING_SEQNO);if(!await Dc(r,this.encodeMessage.bind(this)))throw new at("StrictSigning: Invalid message signature",Bt.ERR_INVALID_SIGNATURE);break;default:throw new at("Cannot validate message: unhandled signature policy",Bt.ERR_UNHANDLED_SIGNATURE_POLICY)}let i=this.topicValidators.get(r.topic);if(i!=null){let s=await i(t,r);if(s===Yn.Reject||s===Yn.Ignore)throw new at("Message validation failed",Bt.ERR_TOPIC_VALIDATOR_REJECT)}}async buildMessage(t){switch(this.globalSignaturePolicy){case"StrictSign":return await Pc(this.components.peerId,t,this.encodeMessage.bind(this));case"StrictNoSign":return await Promise.resolve({type:"unsigned",...t});default:throw new at("Cannot build message: unhandled signature policy",Bt.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(t){if(!this.started)throw new at("not started yet","ERR_NOT_STARTED_YET");if(t==null)throw new at("topic is required","ERR_NOT_VALID_TOPIC");let r=this.topics.get(t.toString());return r==null?[]:Array.from(r.values())}async publish(t,r){if(!this.started)throw new Error("Pubsub has not started");let n={from:this.components.peerId,topic:t,data:r??new Uint8Array(0),sequenceNumber:Ic()};it("publish topic: %s from: %p data: %m",t,n.from,n.data);let i=await this.buildMessage(n),s=!1;this.emitSelf&&this.subscriptions.has(t)&&(s=!0,super.dispatchEvent(new le("message",{detail:i})));let o=await this.publishMessage(this.components.peerId,i);return s&&(o.recipients=[...o.recipients,this.components.peerId]),o}subscribe(t){if(!this.started)throw new Error("Pubsub has not started");if(it("subscribe to topic: %s",t),!this.subscriptions.has(t)){this.subscriptions.add(t);for(let r of this.peers.keys())this.send(r,{subscriptions:[t],subscribe:!0})}}unsubscribe(t){if(!this.started)throw new Error("Pubsub is not started");super.removeEventListener(t);let r=this.subscriptions.has(t);if(it("unsubscribe from %s - am subscribed %s",t,r),r){this.subscriptions.delete(t);for(let n of this.peers.keys())this.send(n,{subscriptions:[t],subscribe:!1})}}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}getPeers(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.peers.keys())}};return Oc(Ag);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PPubsub}));
